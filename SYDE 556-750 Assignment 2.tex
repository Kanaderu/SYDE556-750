
% Default to the notebook output style

    


% Inherit from the specified cell style.




    
\documentclass{article}

    
    
    \usepackage{graphicx} % Used to insert images
    \usepackage{adjustbox} % Used to constrain images to a maximum size 
    \usepackage{color} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage[utf8x]{inputenc} % Allow utf-8 characters in the tex document
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range 
    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage{ulem} % ulem is needed to support strikethroughs (\sout)
    

    
    
    \definecolor{orange}{cmyk}{0,0.4,0.8,0.2}
    \definecolor{darkorange}{rgb}{.71,0.21,0.01}
    \definecolor{darkgreen}{rgb}{.12,.54,.11}
    \definecolor{myteal}{rgb}{.26, .44, .56}
    \definecolor{gray}{gray}{0.45}
    \definecolor{lightgray}{gray}{.95}
    \definecolor{mediumgray}{gray}{.8}
    \definecolor{inputbackground}{rgb}{.95, .95, .85}
    \definecolor{outputbackground}{rgb}{.95, .95, .95}
    \definecolor{traceback}{rgb}{1, .95, .95}
    % ansi colors
    \definecolor{red}{rgb}{.6,0,0}
    \definecolor{green}{rgb}{0,.65,0}
    \definecolor{brown}{rgb}{0.6,0.6,0}
    \definecolor{blue}{rgb}{0,.145,.698}
    \definecolor{purple}{rgb}{.698,.145,.698}
    \definecolor{cyan}{rgb}{0,.698,.698}
    \definecolor{lightgray}{gray}{0.5}
    
    % bright ansi colors
    \definecolor{darkgray}{gray}{0.25}
    \definecolor{lightred}{rgb}{1.0,0.39,0.28}
    \definecolor{lightgreen}{rgb}{0.48,0.99,0.0}
    \definecolor{lightblue}{rgb}{0.53,0.81,0.92}
    \definecolor{lightpurple}{rgb}{0.87,0.63,0.87}
    \definecolor{lightcyan}{rgb}{0.5,1.0,0.83}
    
    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatability definitions
    \def\gt{>}
    \def\lt{<}
    % Document parameters
    \title{SYDE 556-750 Assignment 2}
    
    
    

    % Pygments definitions
    
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\expandafter\def\csname PY@tok@gd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@gu\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PY@tok@gs\endcsname{\let\PY@bf=\textbf}
\expandafter\def\csname PY@tok@gr\endcsname{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@cm\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@vg\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@m\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@go\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\expandafter\def\csname PY@tok@ge\endcsname{\let\PY@it=\textit}
\expandafter\def\csname PY@tok@vc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@il\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@cs\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\expandafter\def\csname PY@tok@gi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@gh\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@ni\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\expandafter\def\csname PY@tok@nl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@nn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@no\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@na\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\expandafter\def\csname PY@tok@nb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@ne\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\expandafter\def\csname PY@tok@nf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@si\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@s2\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@vi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@nt\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nv\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@s1\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@kd\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@sh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sx\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@bp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@c1\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@kc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@c\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@mf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@err\endcsname{\def\PY@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PY@tok@mb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ss\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sr\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@mo\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@kn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@mi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@gp\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@o\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@kr\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@s\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@kp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@w\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PY@tok@kt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\expandafter\def\csname PY@tok@ow\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@sb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@k\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@se\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\expandafter\def\csname PY@tok@sd\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % Exact colors from NB
    \definecolor{incolor}{rgb}{0.0, 0.0, 0.5}
    \definecolor{outcolor}{rgb}{0.545, 0.0, 0.0}



    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=blue,
      linkcolor=darkorange,
      citecolor=darkgreen,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

    \begin{document}
    
    
    \maketitle
    
    

    
    \subsection{SYDE556/750 Assignment 2: Spiking
Neurons}\label{syde556750-assignment-2-spiking-neurons}

\begin{itemize}
\itemsep1pt\parskip0pt\parsep0pt
\item
  Due Date: Feb 22th: Assignment \#2 (due at midnight)
\item
  Total marks: 20 (20\% of final grade)
\item
  Late penalty: 1 mark per day
\item
  It is recommended that you use a language with a matrix library and
  graphing capabilities. Two main suggestions are Python and MATLAB.
\item
  \emph{Do not use any code from Nengo}
\end{itemize}

    \subsection{1) Generating a random input
signal}\label{generating-a-random-input-signal}

\subsubsection{1.1) Gaussian white noise}\label{gaussian-white-noise}

Create a function called that generates a randomly varying $x(t)$ signal
chosen from a white noise distribution. Call it `generate\_signal' and
ensure that it returns $x(t)$ and $X(\omega)$. The inputs to the
function are:

\begin{itemize}
\item
  \texttt{T}: the length of the signal in seconds
\item
  \texttt{dt}: the time step in seconds
\item
  \texttt{rms}: the root mean square power level of the signal. That is,
  the resulting signal should have
  $\sqrt{\frac{1}{T} \int{x(t)^2}dt}=rms$
\item
  \texttt{limit}: the maximum frequency for the signal (in Hz)
\item
  \texttt{seed}: the random number seed to use (so we can regenerate the
  same signal again)
\item
  $\Delta \omega$ will be $2 \pi / T$
\item
  To keep the signal real, $X(\omega)=X(-\omega)^*$ (the complex
  conjugate: the real parts are equal, and the imaginary parts switch
  sign)
\item
  When randomly generating $X(\omega)$ values, sample them from a Normal
  distribution $N(\mu=0,\sigma=1)$. Remember that these are complex
  numbers, so sample twice from the distribution; once for the real
  component and once for the imaginary.
\item
  To implement the \texttt{limit}, set all $X(\omega)$ components with
  frequencies above the limit to 0
\item
  To implement the \texttt{rms}, generate the signal, compute its RMS
  power ($\sqrt{\frac{1}{T} \int{x(t)^2}dt}=rms$) and rescale so it has
  the desired power.
\end{itemize}

    \subsubsection{These are the helper functions needed I wrote for the
assignment. Evaluate these cells
first.}\label{these-are-the-helper-functions-needed-i-wrote-for-the-assignment.-evaluate-these-cells-first.}

\paragraph{To find $\alpha$ and
$J^{bias}$:}\label{to-find-alpha-and-jbias}

In the general case, $\alpha$ and $J^{bias}$ can be calculated from two
known points, $(x_1, a_1), (x_2, a_2)$ and the standard LIF
approximation $a(J)=\frac{1} {\tau_{ref}-\tau_{RC}ln(1-\frac{1}{J})}$:

\begin{itemize}
\item
  $J^{bias} = (\frac{1}{1-\frac{x_2 \cdot e}{x_1 \cdot e}}) * (\frac{1}{1-e^{\frac{\tau_{ref} - a_2^{-1}}{\tau_{rc}}}} - \frac{x_2 \cdot e}{x_1 \cdot e} * \frac{1}{1-e^{\frac{\tau_{ref} - a_1^{-1}}{\tau_{rc}}}})$
\item
  $\alpha=(\frac{1}{x_2 \cdot e})*(\frac{1}{1-e^{\frac{\tau_{ref} - a_2^{-1}}{\tau_{rc}}}} - J^{bias})$
\end{itemize}

These equations simplify in the case of $x_1 \cdot e=0$ to

\begin{itemize}
\item
  $J^{bias} = \frac{1}{1-e^{\frac{\tau_{ref} - a_1^{-1}}{\tau_{rc}}}}$
\item
  $\alpha = (\frac{1}{x_2 \cdot e}) * (\frac{1}{1-e^{\frac{\tau_{ref} - a_2^{-1}}{\tau_{rc}}}} - J^{bias})$
\end{itemize}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}119}]:} \PY{o}{\PYZpc{}}\PY{k}{pylab} inline
          \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k+kn}{as} \PY{n+nn}{np}
          \PY{k+kn}{import} \PY{n+nn}{matplotlib.pyplot} \PY{k+kn}{as} \PY{n+nn}{plt}
          \PY{n}{plt}\PY{o}{.}\PY{n}{rcParams}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{lines.linewidth}\PY{l+s}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{4}
          \PY{n}{plt}\PY{o}{.}\PY{n}{rcParams}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{font.size}\PY{l+s}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{24}
          
          \PY{k}{class} \PY{n+nc}{spikingLIFneuron}\PY{p}{(}\PY{p}{)}\PY{p}{:}
          
              \PY{k}{def} \PY{n+nf}{\PYZus{}\PYZus{}init\PYZus{}\PYZus{}}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,}\PY{n}{x1\PYZus{}dot\PYZus{}e}\PY{p}{,}\PY{n}{x2\PYZus{}dot\PYZus{}e}\PY{p}{,}\PY{n}{a1}\PY{p}{,}\PY{n}{a2}\PY{p}{,}\PY{n}{encoder}\PY{p}{,}\PY{n}{tau\PYZus{}ref}\PY{p}{,}\PY{n}{tau\PYZus{}rc}\PY{p}{)}\PY{p}{:}
                  \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{x1\PYZus{}dot\PYZus{}e}\PY{o}{=}\PY{n+nb}{float}\PY{p}{(}\PY{n}{x1\PYZus{}dot\PYZus{}e}\PY{p}{)}
                  \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{x2\PYZus{}dot\PYZus{}e}\PY{o}{=}\PY{n+nb}{float}\PY{p}{(}\PY{n}{x2\PYZus{}dot\PYZus{}e}\PY{p}{)}
                  \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{a1}\PY{o}{=}\PY{n+nb}{float}\PY{p}{(}\PY{n}{a1}\PY{p}{)}
                  \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{a2}\PY{o}{=}\PY{n+nb}{float}\PY{p}{(}\PY{n}{a2}\PY{p}{)}
                  \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{e}\PY{o}{=}\PY{n}{encoder}
                  \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{tau\PYZus{}ref}\PY{o}{=}\PY{n}{tau\PYZus{}ref}
                  \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{tau\PYZus{}rc}\PY{o}{=}\PY{n}{tau\PYZus{}rc}
                  \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{Jbias}\PY{o}{=}\PY{l+m+mf}{0.0}
                  \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{alpha}\PY{o}{=}\PY{l+m+mf}{0.0}
                  \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{V}\PY{o}{=}\PY{l+m+mf}{0.0}
                  \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{dVdt}\PY{o}{=}\PY{l+m+mf}{0.0}
                  \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{stimulus}\PY{o}{=}\PY{p}{[}\PY{p}{]}
                  \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{spikes}\PY{o}{=}\PY{p}{[}\PY{p}{]}
                  \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{Vhistory}\PY{o}{=}\PY{p}{[}\PY{p}{]}
          
                  \PY{c}{\PYZsh{}alpha and Jbias calculation}
                  \PY{k}{if} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{x1\PYZus{}dot\PYZus{}e}\PY{o}{==}\PY{l+m+mi}{0}\PY{p}{:}
                      \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{Jbias}\PY{o}{=}\PY{l+m+mi}{1}\PY{o}{/}\PY{p}{(}\PY{l+m+mi}{1}\PY{o}{\PYZhy{}}\PY{n}{np}\PY{o}{.}\PY{n}{exp}\PY{p}{(}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{tau\PYZus{}ref} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1}\PY{o}{/}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{a1}\PY{p}{)}\PY{o}{/}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{tau\PYZus{}rc}\PY{p}{)}\PY{p}{)}
                      \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{alpha}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{1}\PY{o}{/}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{x2\PYZus{}dot\PYZus{}e}\PY{p}{)}\PY{o}{*}\PYZbs{}
                              \PY{p}{(}\PY{l+m+mi}{1}\PY{o}{/}\PY{p}{(}\PY{l+m+mi}{1}\PY{o}{\PYZhy{}}\PY{n}{np}\PY{o}{.}\PY{n}{exp}\PY{p}{(}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{tau\PYZus{}ref} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1}\PY{o}{/}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{a2}\PY{p}{)}\PY{o}{/}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{tau\PYZus{}rc}\PY{p}{)}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{Jbias}\PY{p}{)}
                  \PY{k}{elif} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{x2\PYZus{}dot\PYZus{}e}\PY{o}{==}\PY{l+m+mi}{0}\PY{p}{:}
                      \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{Jbias}\PY{o}{=}\PY{l+m+mi}{1}\PY{o}{/}\PY{p}{(}\PY{l+m+mi}{1}\PY{o}{\PYZhy{}}\PY{n}{np}\PY{o}{.}\PY{n}{exp}\PY{p}{(}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{tau\PYZus{}ref} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1}\PY{o}{/}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{a2}\PY{p}{)}\PY{o}{/}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{tau\PYZus{}rc}\PY{p}{)}\PY{p}{)}
                      \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{alpha}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{1}\PY{o}{/}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{x1\PYZus{}dot\PYZus{}e}\PY{p}{)}\PY{o}{*}\PYZbs{}
                          \PY{p}{(}\PY{l+m+mi}{1}\PY{o}{/}\PY{p}{(}\PY{l+m+mi}{1}\PY{o}{\PYZhy{}}\PY{n}{np}\PY{o}{.}\PY{n}{exp}\PY{p}{(}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{tau\PYZus{}ref} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1}\PY{o}{/}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{a1}\PY{p}{)}\PY{o}{/}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{tau\PYZus{}rc}\PY{p}{)}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{Jbias}\PY{p}{)}
                  \PY{c}{\PYZsh{}general case}
                  \PY{k}{else}\PY{p}{:}
                      \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{Jbias}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{1}\PY{o}{/}\PY{p}{(}\PY{l+m+mi}{1}\PY{o}{\PYZhy{}}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{x2\PYZus{}dot\PYZus{}e}\PY{o}{/}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{x1\PYZus{}dot\PYZus{}e}\PY{p}{)}\PY{p}{)}\PY{o}{\PYZhy{}}\PYZbs{}
                        \PY{l+m+mi}{1}\PY{o}{/}\PY{p}{(}\PY{l+m+mi}{1}\PY{o}{\PYZhy{}}\PY{n}{np}\PY{o}{.}\PY{n}{exp}\PY{p}{(}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{tau\PYZus{}ref} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1}\PY{o}{/}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{a2}\PY{p}{)}\PY{o}{/}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{tau\PYZus{}rc}\PY{p}{)}\PY{p}{)}\PY{o}{\PYZhy{}}\PYZbs{}
                        \PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{x2\PYZus{}dot\PYZus{}e}\PY{o}{/}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{x1\PYZus{}dot\PYZus{}e}\PY{p}{)}\PY{o}{*}\PYZbs{}
                        \PY{l+m+mi}{1}\PY{o}{/}\PY{p}{(}\PY{l+m+mi}{1}\PY{o}{\PYZhy{}}\PY{n}{np}\PY{o}{.}\PY{n}{exp}\PY{p}{(}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{tau\PYZus{}ref} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1}\PY{o}{/}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{a1}\PY{p}{)}\PY{o}{/}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{tau\PYZus{}rc}\PY{p}{)}\PY{p}{)}
                      \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{alpha}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{1}\PY{o}{/}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{x2\PYZus{}dot\PYZus{}e}\PY{p}{)}\PY{o}{*}\PYZbs{}
                        \PY{p}{(}\PY{l+m+mi}{1}\PY{o}{/}\PY{p}{(}\PY{l+m+mi}{1}\PY{o}{\PYZhy{}}\PY{n}{np}\PY{o}{.}\PY{n}{exp}\PY{p}{(}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{tau\PYZus{}ref} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1}\PY{o}{/}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{a2}\PY{p}{)}\PY{o}{/}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{tau\PYZus{}rc}\PY{p}{)}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{Jbias}\PY{p}{)}
          
              \PY{k}{def} \PY{n+nf}{set\PYZus{}spikes}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,}\PY{n}{stimulus}\PY{p}{,}\PY{n}{T}\PY{p}{,}\PY{n}{dt}\PY{p}{)}\PY{p}{:}
                  \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{stimulus}\PY{o}{=}\PY{n}{stimulus} \PY{c}{\PYZsh{}an array}
                  \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{spikes}\PY{o}{=}\PY{p}{[}\PY{p}{]}
                  \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{Vhistory}\PY{o}{=}\PY{p}{[}\PY{p}{]}
                  \PY{n}{ref\PYZus{}window}\PY{o}{=}\PY{n+nb}{int}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{tau\PYZus{}ref}\PY{o}{/}\PY{n}{dt}\PY{p}{)} \PY{c}{\PYZsh{}number of timesteps in refractory period}
          
                  \PY{k}{for} \PY{n}{t} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{stimulus}\PY{p}{)}\PY{p}{)}\PY{p}{:}
                      \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{J}\PY{o}{=}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{alpha}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{stimulus}\PY{p}{[}\PY{n}{t}\PY{p}{]}\PY{p}{,}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{e}\PY{p}{)} \PY{o}{+} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{Jbias}
                      \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{dVdt}\PY{o}{=}\PY{p}{(}\PY{p}{(}\PY{l+m+mi}{1}\PY{o}{/}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{tau\PYZus{}rc}\PY{p}{)}\PY{o}{*}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{J}\PY{o}{\PYZhy{}}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{V}\PY{p}{)}\PY{p}{)}
                      \PY{c}{\PYZsh{}check if there have been spikes in the last tau\PYZus{}rc seconds}
                      \PY{k}{for} \PY{n}{h} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{ref\PYZus{}window}\PY{p}{)}\PY{p}{:}   
                          \PY{k}{if} \PY{n+nb}{len}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{spikes}\PY{p}{)} \PY{o}{\PYZgt{}}\PY{o}{=} \PY{n}{ref\PYZus{}window} \PY{o+ow}{and} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{spikes}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{p}{(}\PY{n}{h}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{]} \PY{o}{==} \PY{l+m+mi}{1}\PY{p}{:}
                              \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{dVdt}\PY{o}{=}\PY{l+m+mi}{0}     \PY{c}{\PYZsh{}if so, voltage isn\PYZsq{}t allowed to change}
                      \PY{c}{\PYZsh{}Euler\PYZsq{}s Method Approximation V(t+1) = V(t) + dt *dV(t)/dt}
                      \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{V}\PY{o}{=}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{V}\PY{o}{+}\PY{n}{dt}\PY{o}{*}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{dVdt}  
                      \PY{k}{if} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{V} \PY{o}{\PYZgt{}}\PY{o}{=} \PY{l+m+mf}{1.0}\PY{p}{:}
                          \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{spikes}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{)}   \PY{c}{\PYZsh{}a spike}
                          \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{V}\PY{o}{=}\PY{l+m+mf}{0.0}    \PY{c}{\PYZsh{}reset}
                      \PY{k}{else}\PY{p}{:}
                          \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{spikes}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}   \PY{c}{\PYZsh{}not a spike}
                          \PY{k}{if} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{V} \PY{o}{\PYZlt{}} \PY{l+m+mf}{0.0}\PY{p}{:} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{V}\PY{o}{=}\PY{l+m+mf}{0.0}
                      \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{Vhistory}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{V}\PY{p}{)}
          
              \PY{k}{def} \PY{n+nf}{get\PYZus{}spikes}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{)}\PY{p}{:}
                  \PY{k}{return} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{spikes}
          
          \PY{k}{def} \PY{n+nf}{get\PYZus{}decoders\PYZus{}smoothed}\PY{p}{(}\PY{n}{spikes}\PY{p}{,}\PY{n}{h}\PY{p}{,}\PY{n}{x}\PY{p}{)}\PY{p}{:}
          
              \PY{n}{S}\PY{o}{=}\PY{n+nb}{len}\PY{p}{(}\PY{n}{x}\PY{p}{)}
              \PY{c}{\PYZsh{}have to truncate from \PYZsq{}full\PYZsq{} here, mode=\PYZsq{}same\PYZsq{} messes up last half of list}
              \PY{n}{A\PYZus{}T}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{n}{np}\PY{o}{.}\PY{n}{convolve}\PY{p}{(}\PY{n}{s}\PY{p}{,}\PY{n}{h}\PY{p}{,}\PY{n}{mode}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{full}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{[}\PY{p}{:}\PY{n+nb}{len}\PY{p}{(}\PY{n}{spikes}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{]} \PY{k}{for} \PY{n}{s} \PY{o+ow}{in} \PY{n}{spikes}\PY{p}{]}\PY{p}{)} 
              \PY{n}{A}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{matrix}\PY{p}{(}\PY{n}{A\PYZus{}T}\PY{p}{)}\PY{o}{.}\PY{n}{T}
              \PY{n}{x}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{matrix}\PY{p}{(}\PY{n}{x}\PY{p}{)}\PY{o}{.}\PY{n}{T}
              \PY{n}{upsilon}\PY{o}{=}\PY{n}{A\PYZus{}T}\PY{o}{*}\PY{n}{x}\PY{o}{/}\PY{n}{S}
              \PY{n}{gamma}\PY{o}{=}\PY{n}{A\PYZus{}T}\PY{o}{*}\PY{n}{A}\PY{o}{/}\PY{n}{S}
              \PY{n}{d}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{linalg}\PY{o}{.}\PY{n}{pinv}\PY{p}{(}\PY{n}{gamma}\PY{p}{)}\PY{o}{*}\PY{n}{upsilon}
              \PY{k}{return} \PY{n}{d}
          
          \PY{k}{def} \PY{n+nf}{get\PYZus{}estimate\PYZus{}smoothed}\PY{p}{(}\PY{n}{spikes}\PY{p}{,}\PY{n}{h}\PY{p}{,}\PY{n}{d}\PY{p}{)}\PY{p}{:}
          
              \PY{c}{\PYZsh{}have to truncate from \PYZsq{}full\PYZsq{} here, mode=\PYZsq{}same\PYZsq{} messes up last half of list}
              \PY{n}{xhat}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{[}\PY{n}{d}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{convolve}\PY{p}{(}\PY{n}{spikes}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{,}\PY{n}{h}\PY{p}{,}\PY{n}{mode}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{full}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PYZbs{}
                           \PY{p}{[}\PY{p}{:}\PY{n+nb}{len}\PY{p}{(}\PY{n}{spikes}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}\PY{p}{]} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{d}\PY{p}{)}\PY{p}{)}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
              \PY{n}{xhat}\PY{o}{=}\PY{n}{xhat}\PY{o}{.}\PY{n}{T}
              \PY{k}{return} \PY{n}{xhat}
          
          \PY{k}{def} \PY{n+nf}{generate\PYZus{}signal}\PY{p}{(}\PY{n}{T}\PY{p}{,}\PY{n}{dt}\PY{p}{,}\PY{n}{rms}\PY{p}{,}\PY{n}{limit}\PY{p}{,}\PY{n}{seed}\PY{p}{,}\PY{n}{distribution}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{uniform}\PY{l+s}{\PYZsq{}}\PY{p}{)}\PY{p}{:}
          
              \PY{c}{\PYZsh{}first generate X(w), with the specified constraints, then use an inverse fft to get x\PYZus{}t}
              \PY{n}{rng}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{RandomState}\PY{p}{(}\PY{n}{seed}\PY{o}{=}\PY{n}{seed}\PY{p}{)}
              \PY{n}{t}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{n+nb}{int}\PY{p}{(}\PY{n}{T}\PY{o}{/}\PY{n}{dt}\PY{p}{)}\PY{p}{)}\PY{o}{*}\PY{n}{dt}
              \PY{n}{delta\PYZus{}w} \PY{o}{=} \PY{l+m+mi}{2}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{pi}\PY{o}{/}\PY{n}{T} \PY{c}{\PYZsh{}omega stepsize}
              \PY{n}{w\PYZus{}vals} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n+nb}{len}\PY{p}{(}\PY{n}{t}\PY{p}{)}\PY{o}{/}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{delta\PYZus{}w}\PY{p}{)} \PY{c}{\PYZsh{}make half of X(w), those with negative freq}
              \PY{n}{w\PYZus{}limit}\PY{o}{=}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{pi}\PY{o}{*}\PY{n}{limit} \PY{c}{\PYZsh{}frequency in radians}
              \PY{n}{bandwidth}\PY{o}{=}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{pi}\PY{o}{*}\PY{n}{limit} \PY{c}{\PYZsh{}bandwidth in radians}
              \PY{n}{x\PYZus{}w\PYZus{}half1}\PY{o}{=}\PY{p}{[}\PY{p}{]}
              \PY{n}{x\PYZus{}w\PYZus{}half2}\PY{o}{=}\PY{p}{[}\PY{p}{]}
          
              \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{w\PYZus{}vals}\PY{p}{)}\PY{p}{)}\PY{p}{:}    \PY{c}{\PYZsh{}loop over frequency values}
                  \PY{k}{if} \PY{n}{distribution}\PY{o}{==}\PY{l+s}{\PYZsq{}}\PY{l+s}{uniform}\PY{l+s}{\PYZsq{}}\PY{p}{:}
                      \PY{c}{\PYZsh{}if |w| is within the specified limit, generate a coefficient}
                      \PY{k}{if} \PY{n+nb}{abs}\PY{p}{(}\PY{n}{w\PYZus{}vals}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)} \PY{o}{\PYZlt{}} \PY{n}{w\PYZus{}limit}\PY{p}{:}    
                          \PY{n}{x\PYZus{}w\PYZus{}i\PYZus{}real} \PY{o}{=} \PY{n}{rng}\PY{o}{.}\PY{n}{normal}\PY{p}{(}\PY{n}{loc}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{scale}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}  \PY{c}{\PYZsh{}mean=0, sigma=1}
                          \PY{n}{x\PYZus{}w\PYZus{}i\PYZus{}im} \PY{o}{=} \PY{n}{rng}\PY{o}{.}\PY{n}{normal}\PY{p}{(}\PY{n}{loc}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{scale}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
                          \PY{n}{x\PYZus{}w\PYZus{}half1}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{x\PYZus{}w\PYZus{}i\PYZus{}real} \PY{o}{+} \PY{l+m+mi}{1j}\PY{o}{*}\PY{n}{x\PYZus{}w\PYZus{}i\PYZus{}im}\PY{p}{)}
                          \PY{c}{\PYZsh{}make the 2nd half of X(w) with complex conjugates}
                          \PY{n}{x\PYZus{}w\PYZus{}half2}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{x\PYZus{}w\PYZus{}i\PYZus{}real} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1j}\PY{o}{*}\PY{n}{x\PYZus{}w\PYZus{}i\PYZus{}im}\PY{p}{)}  
          
                  \PY{k}{elif} \PY{n}{distribution}\PY{o}{==}\PY{l+s}{\PYZsq{}}\PY{l+s}{gaussian}\PY{l+s}{\PYZsq{}}\PY{p}{:}
                      \PY{c}{\PYZsh{}draw sigma from a gaussian distribution}
                      \PY{n}{sigma}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{exp}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{np}\PY{o}{.}\PY{n}{square}\PY{p}{(}\PY{n}{w\PYZus{}vals}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}\PY{o}{/}\PY{p}{(}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{square}\PY{p}{(}\PY{n}{bandwidth}\PY{p}{)}\PY{p}{)}\PY{p}{)}
                      \PY{k}{if} \PY{n}{sigma} \PY{o}{\PYZgt{}} \PY{n}{np}\PY{o}{.}\PY{n}{finfo}\PY{p}{(}\PY{n+nb}{float}\PY{p}{)}\PY{o}{.}\PY{n}{eps}\PY{p}{:} \PY{c}{\PYZsh{}distinguishable from zero}
                          \PY{n}{x\PYZus{}w\PYZus{}i\PYZus{}real} \PY{o}{=} \PY{n}{rng}\PY{o}{.}\PY{n}{normal}\PY{p}{(}\PY{n}{loc}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{scale}\PY{o}{=}\PY{n}{sigma}\PY{p}{)}
                          \PY{n}{x\PYZus{}w\PYZus{}i\PYZus{}im} \PY{o}{=} \PY{n}{rng}\PY{o}{.}\PY{n}{normal}\PY{p}{(}\PY{n}{loc}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{scale}\PY{o}{=}\PY{n}{sigma}\PY{p}{)}  
                          \PY{n}{x\PYZus{}w\PYZus{}half1}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{x\PYZus{}w\PYZus{}i\PYZus{}real} \PY{o}{+} \PY{l+m+mi}{1j}\PY{o}{*}\PY{n}{x\PYZus{}w\PYZus{}i\PYZus{}im}\PY{p}{)}
                          \PY{n}{x\PYZus{}w\PYZus{}half2}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{x\PYZus{}w\PYZus{}i\PYZus{}real} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1j}\PY{o}{*}\PY{n}{x\PYZus{}w\PYZus{}i\PYZus{}im}\PY{p}{)}  
          
              \PY{c}{\PYZsh{}zero pad the positive and negative amplitude lists, so each is len(samples/2)}
              \PY{n}{x\PYZus{}w\PYZus{}pos}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{hstack}\PY{p}{(}\PY{p}{(}\PY{n}{x\PYZus{}w\PYZus{}half2}\PY{p}{[}\PY{p}{:}\PY{p}{:}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{t}\PY{p}{)}\PY{o}{/}\PY{l+m+mi}{2}\PY{o}{\PYZhy{}}\PY{n+nb}{len}\PY{p}{(}\PY{n}{x\PYZus{}w\PYZus{}half2}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{p}{)}
              \PY{n}{x\PYZus{}w\PYZus{}neg}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{hstack}\PY{p}{(}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{t}\PY{p}{)}\PY{o}{/}\PY{l+m+mi}{2}\PY{o}{\PYZhy{}}\PY{n+nb}{len}\PY{p}{(}\PY{n}{x\PYZus{}w\PYZus{}half1}\PY{p}{)}\PY{p}{)}\PY{p}{,}\PY{n}{x\PYZus{}w\PYZus{}half1}\PY{p}{)}\PY{p}{)}
              \PY{c}{\PYZsh{}assemble the symmetric X(w) according to numpy.fft documentation}
              \PY{c}{\PYZsh{}amplitudes corresponding to [w\PYZus{}0, w\PYZus{}pos increasing, w\PYZus{}neg increasing]}
              \PY{n}{x\PYZus{}w}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{hstack}\PY{p}{(}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{0}\PY{o}{+}\PY{l+m+mi}{0j}\PY{p}{]}\PY{p}{,}\PY{n}{x\PYZus{}w\PYZus{}pos}\PY{p}{,}\PY{n}{x\PYZus{}w\PYZus{}neg}\PY{p}{)}\PY{p}{)}
              \PY{n}{x\PYZus{}t}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{fft}\PY{o}{.}\PY{n}{ifft}\PY{p}{(}\PY{n}{x\PYZus{}w}\PY{p}{)}
              \PY{c}{\PYZsh{}normalize time and frequency signals using RMS}
              \PY{n}{true\PYZus{}rms}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{n}{dt}\PY{o}{/}\PY{n}{T}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{square}\PY{p}{(}\PY{n}{x\PYZus{}t}\PY{p}{)}\PY{p}{)}\PY{p}{)}   
              \PY{n}{x\PYZus{}t} \PY{o}{=} \PY{n}{x\PYZus{}t}\PY{o}{*}\PY{n}{rms}\PY{o}{/}\PY{n}{true\PYZus{}rms}
              \PY{n}{x\PYZus{}w} \PY{o}{=} \PY{n}{x\PYZus{}w}\PY{o}{*}\PY{n}{rms}\PY{o}{/}\PY{n}{true\PYZus{}rms}
          
              \PY{c}{\PYZsh{}return real part of signal to avoid warning, but I promise they are less than e\PYZhy{}15}
              \PY{k}{return} \PY{n}{x\PYZus{}t}\PY{o}{.}\PY{n}{real}\PY{p}{,} \PY{n}{x\PYZus{}w}     
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
Populating the interactive namespace from numpy and matplotlib
    \end{Verbatim}

    \paragraph{1.1a Plot $x(t)$ for three randomly generated signals with
\texttt{limit} at 5, 10, and 20Hz. For each of these, \texttt{T}=1,
\texttt{dt}=0.001, and
\texttt{rms}=0.5.}\label{a-plot-xt-for-three-randomly-generated-signals-with-limit-at-5-10-and-20hz.-for-each-of-these-t1-dt0.001-and-rms0.5.}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}120}]:} \PY{k}{def} \PY{n+nf}{one\PYZus{}pt\PYZus{}one\PYZus{}a}\PY{p}{(}\PY{p}{)}\PY{p}{:}
          
              \PY{n}{T}\PY{o}{=}\PY{l+m+mi}{1}
              \PY{n}{dt}\PY{o}{=}\PY{l+m+mf}{0.001}
              \PY{n}{rms}\PY{o}{=}\PY{l+m+mf}{0.5}
              \PY{n}{limit}\PY{o}{=}\PY{l+m+mi}{10}
              \PY{n}{seed}\PY{o}{=}\PY{l+m+mi}{1}
              \PY{n}{t}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{n+nb}{int}\PY{p}{(}\PY{n}{T}\PY{o}{/}\PY{n}{dt}\PY{p}{)}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{*}\PY{n}{dt}
          
              \PY{n}{limits}\PY{o}{=}\PY{p}{[}\PY{l+m+mi}{5}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{,}\PY{l+m+mi}{20}\PY{p}{]}
              \PY{n}{x\PYZus{}t\PYZus{}list}\PY{o}{=}\PY{p}{[}\PY{p}{]}
              \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{limits}\PY{p}{)}\PY{p}{)}\PY{p}{:}  
                  \PY{n}{seed}\PY{o}{=}\PY{n}{i}
                  \PY{n}{limit}\PY{o}{=}\PY{n}{limits}\PY{p}{[}\PY{n}{i}\PY{p}{]}
                  \PY{n}{x\PYZus{}ti}\PY{p}{,} \PY{n}{x\PYZus{}wi} \PY{o}{=} \PY{n}{generate\PYZus{}signal}\PY{p}{(}\PY{n}{T}\PY{p}{,}\PY{n}{dt}\PY{p}{,}\PY{n}{rms}\PY{p}{,}\PY{n}{limit}\PY{p}{,}\PY{n}{seed}\PY{p}{,}\PY{l+s}{\PYZsq{}}\PY{l+s}{uniform}\PY{l+s}{\PYZsq{}}\PY{p}{)}
                  \PY{n}{x\PYZus{}t\PYZus{}list}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{x\PYZus{}ti}\PY{p}{)}
          
              \PY{n}{fig}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{16}\PY{p}{,}\PY{l+m+mi}{8}\PY{p}{)}\PY{p}{)}
              \PY{n}{ax}\PY{o}{=}\PY{n}{fig}\PY{o}{.}\PY{n}{add\PYZus{}subplot}\PY{p}{(}\PY{l+m+mi}{111}\PY{p}{)}
              \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{limits}\PY{p}{)}\PY{p}{)}\PY{p}{:}  
                  \PY{n}{ax}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{t}\PY{p}{,}\PY{n}{x\PYZus{}t\PYZus{}list}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{limit=}\PY{l+s+si}{\PYZpc{}s}\PY{l+s}{Hz}\PY{l+s}{\PYZsq{}} \PY{o}{\PYZpc{}}\PY{p}{(}\PY{n}{limits}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}\PY{p}{)}
              \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{time (s)}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{\PYZdl{}x(t)\PYZdl{}}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{n}{legend}\PY{o}{=}\PY{n}{ax}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{loc}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{best}\PY{l+s}{\PYZsq{}}\PY{p}{,}\PY{n}{shadow}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
              \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
          
          \PY{n}{one\PYZus{}pt\PYZus{}one\PYZus{}a}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{SYDE 556-750 Assignment 2_files/SYDE 556-750 Assignment 2_5_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \paragraph{1.1b Plot the average $|X(\omega)|$ (the norm of the Fourier
coefficients) over 100 signals generated with \texttt{T}=1,
\texttt{dt}=0.001, \texttt{rms}=0.5, and \texttt{limit}=10 (each of
these 100 signals should have a different \texttt{seed}). The plot
should have the x-axis labeled ($\omega$ in radians) and the average
$|X|$ value for that $\omega$ on the
y-axis.}\label{b-plot-the-average-xomega-the-norm-of-the-fourier-coefficients-over-100-signals-generated-with-t1-dt0.001-rms0.5-and-limit10-each-of-these-100-signals-should-have-a-different-seed.-the-plot-should-have-the-x-axis-labeled-omega-in-radians-and-the-average-x-value-for-that-omega-on-the-y-axis.}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}121}]:} \PY{k}{def} \PY{n+nf}{one\PYZus{}pt\PYZus{}one\PYZus{}b}\PY{p}{(}\PY{p}{)}\PY{p}{:}
          
              \PY{n}{T}\PY{o}{=}\PY{l+m+mi}{1}
              \PY{n}{dt}\PY{o}{=}\PY{l+m+mf}{0.001}
              \PY{n}{rms}\PY{o}{=}\PY{l+m+mf}{0.5}
              \PY{n}{limit}\PY{o}{=}\PY{l+m+mi}{10}
              \PY{n}{avgs}\PY{o}{=}\PY{l+m+mi}{100}
          
              \PY{n}{x\PYZus{}w\PYZus{}list}\PY{o}{=}\PY{p}{[}\PY{p}{]}
              \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{avgs}\PY{p}{)}\PY{p}{:}
                  \PY{n}{seed}\PY{o}{=}\PY{n}{i}
                  \PY{n}{x\PYZus{}ti}\PY{p}{,} \PY{n}{x\PYZus{}wi} \PY{o}{=} \PY{n}{generate\PYZus{}signal}\PY{p}{(}\PY{n}{T}\PY{p}{,}\PY{n}{dt}\PY{p}{,}\PY{n}{rms}\PY{p}{,}\PY{n}{limit}\PY{p}{,}\PY{n}{seed}\PY{p}{,}\PY{l+s}{\PYZsq{}}\PY{l+s}{uniform}\PY{l+s}{\PYZsq{}}\PY{p}{)}
                  \PY{n}{x\PYZus{}w\PYZus{}list}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{abs}\PY{p}{(}\PY{n}{x\PYZus{}wi}\PY{p}{)}\PY{p}{)}
              \PY{n}{x\PYZus{}w\PYZus{}avg}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{average}\PY{p}{(}\PY{n}{x\PYZus{}w\PYZus{}list}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
              \PY{n}{w\PYZus{}vals}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{fft}\PY{o}{.}\PY{n}{fftfreq}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{x\PYZus{}w\PYZus{}avg}\PY{p}{)}\PY{p}{)}\PY{o}{*}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{pi}\PY{o}{/}\PY{n}{dt}
              \PY{n}{w\PYZus{}limit}\PY{o}{=}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{pi}\PY{o}{*}\PY{n}{limit}
          
              \PY{n}{fig}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{16}\PY{p}{,}\PY{l+m+mi}{8}\PY{p}{)}\PY{p}{)}
              \PY{n}{ax}\PY{o}{=}\PY{n}{fig}\PY{o}{.}\PY{n}{add\PYZus{}subplot}\PY{p}{(}\PY{l+m+mi}{111}\PY{p}{)}
              \PY{n}{ax}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{sort}\PY{p}{(}\PY{n}{w\PYZus{}vals}\PY{p}{)}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{fft}\PY{o}{.}\PY{n}{fftshift}\PY{p}{(}\PY{n}{x\PYZus{}w\PYZus{}avg}\PY{p}{)}\PY{p}{)}
              \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{\PYZdl{}}\PY{l+s}{\PYZbs{}}\PY{l+s}{omega\PYZdl{}}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{\PYZdl{}|X(}\PY{l+s}{\PYZbs{}}\PY{l+s}{omega)|\PYZdl{}}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlim}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{w\PYZus{}limit}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{w\PYZus{}limit}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}
              \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
              
          \PY{n}{one\PYZus{}pt\PYZus{}one\PYZus{}b}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{SYDE 556-750 Assignment 2_files/SYDE 556-750 Assignment 2_7_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subsubsection{1.2) Gaussian power spectrum
noise}\label{gaussian-power-spectrum-noise}

Create a modified version of your function from question 1.1 that
produces noise with a different power spectrum. Instead of having the
$X(\omega)$ values be 0 outside of some limit and sampled from
$N(\mu=0,\sigma=1)$ inside that limit, we want a smooth drop-off of
power as the frequency increases. In particular, instead of the
\texttt{limit}, we sample from $N(\mu=0,\sigma=e^{-{\omega^2/(2*b^2)}})$
where $b$ is the new \texttt{bandwidth} parameter that replaces the
\texttt{limit} parameter.

    \paragraph{1.2a Plot $x(t)$ for three randomly generated signals with
\texttt{bandwidth} at 5, 10, and 20Hz. For each of these, \texttt{T}=1,
\texttt{dt}=0.001, and
\texttt{rms}=0.5.}\label{a-plot-xt-for-three-randomly-generated-signals-with-bandwidth-at-5-10-and-20hz.-for-each-of-these-t1-dt0.001-and-rms0.5.}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}122}]:} \PY{k}{def} \PY{n+nf}{one\PYZus{}pt\PYZus{}two\PYZus{}a}\PY{p}{(}\PY{p}{)}\PY{p}{:}
          
              \PY{n}{T}\PY{o}{=}\PY{l+m+mi}{1}
              \PY{n}{dt}\PY{o}{=}\PY{l+m+mf}{0.001}
              \PY{n}{rms}\PY{o}{=}\PY{l+m+mf}{0.5}
              \PY{n}{seed}\PY{o}{=}\PY{l+m+mi}{1}
              \PY{n}{t}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{n+nb}{int}\PY{p}{(}\PY{n}{T}\PY{o}{/}\PY{n}{dt}\PY{p}{)}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{*}\PY{n}{dt}
          
              \PY{n}{bandwidths}\PY{o}{=}\PY{p}{[}\PY{l+m+mi}{5}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{,}\PY{l+m+mi}{20}\PY{p}{]}
              \PY{n}{x\PYZus{}t\PYZus{}list}\PY{o}{=}\PY{p}{[}\PY{p}{]}
              \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{bandwidths}\PY{p}{)}\PY{p}{)}\PY{p}{:}  
                  \PY{n}{seed}\PY{o}{=}\PY{n}{i}
                  \PY{n}{bandwidth}\PY{o}{=}\PY{n}{bandwidths}\PY{p}{[}\PY{n}{i}\PY{p}{]}
                  \PY{n}{x\PYZus{}ti}\PY{p}{,} \PY{n}{x\PYZus{}wi} \PY{o}{=} \PY{n}{generate\PYZus{}signal}\PY{p}{(}\PY{n}{T}\PY{p}{,}\PY{n}{dt}\PY{p}{,}\PY{n}{rms}\PY{p}{,}\PY{n}{bandwidth}\PY{p}{,}\PY{n}{seed}\PY{p}{,}\PY{l+s}{\PYZsq{}}\PY{l+s}{gaussian}\PY{l+s}{\PYZsq{}}\PY{p}{)}
                  \PY{n}{x\PYZus{}t\PYZus{}list}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{x\PYZus{}ti}\PY{p}{)}
          
              \PY{n}{fig}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{16}\PY{p}{,}\PY{l+m+mi}{8}\PY{p}{)}\PY{p}{)}
              \PY{n}{ax}\PY{o}{=}\PY{n}{fig}\PY{o}{.}\PY{n}{add\PYZus{}subplot}\PY{p}{(}\PY{l+m+mi}{111}\PY{p}{)}
              \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{bandwidths}\PY{p}{)}\PY{p}{)}\PY{p}{:}  
                  \PY{n}{ax}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{t}\PY{p}{,}\PY{n}{x\PYZus{}t\PYZus{}list}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{bandwidth=}\PY{l+s+si}{\PYZpc{}s}\PY{l+s}{ (Hz)}\PY{l+s}{\PYZsq{}} \PY{o}{\PYZpc{}}\PY{p}{(}\PY{n}{bandwidths}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}\PY{p}{)}
              \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{time (s)}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{\PYZdl{}x(t)\PYZdl{}}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{n}{legend}\PY{o}{=}\PY{n}{ax}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{loc}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{best}\PY{l+s}{\PYZsq{}}\PY{p}{,}\PY{n}{shadow}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
              \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
          
          \PY{n}{one\PYZus{}pt\PYZus{}two\PYZus{}a}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{SYDE 556-750 Assignment 2_files/SYDE 556-750 Assignment 2_10_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \paragraph{1.2b Plot the average $|X(\omega)|$ (the norm of the Fourier
coefficients) over 100 signals generated with \texttt{T}=1,
\texttt{dt}=0.001, \texttt{rms}=0.5, and \texttt{bandwidth}=10 (each of
these 100 signals should have a different
\texttt{seed})}\label{b-plot-the-average-xomega-the-norm-of-the-fourier-coefficients-over-100-signals-generated-with-t1-dt0.001-rms0.5-and-bandwidth10-each-of-these-100-signals-should-have-a-different-seed}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}123}]:} \PY{k}{def} \PY{n+nf}{one\PYZus{}pt\PYZus{}two\PYZus{}b}\PY{p}{(}\PY{p}{)}\PY{p}{:}
          
              \PY{n}{T}\PY{o}{=}\PY{l+m+mi}{1}
              \PY{n}{dt}\PY{o}{=}\PY{l+m+mf}{0.001}
              \PY{n}{rms}\PY{o}{=}\PY{l+m+mf}{0.5}
              \PY{n}{bandwidth}\PY{o}{=}\PY{l+m+mi}{10}
              \PY{n}{avgs}\PY{o}{=}\PY{l+m+mi}{100}
          
              \PY{n}{x\PYZus{}w\PYZus{}list}\PY{o}{=}\PY{p}{[}\PY{p}{]}
              \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{avgs}\PY{p}{)}\PY{p}{:}
                  \PY{n}{seed}\PY{o}{=}\PY{n}{i}
                  \PY{n}{x\PYZus{}ti}\PY{p}{,} \PY{n}{x\PYZus{}wi} \PY{o}{=} \PY{n}{generate\PYZus{}signal}\PY{p}{(}\PY{n}{T}\PY{p}{,}\PY{n}{dt}\PY{p}{,}\PY{n}{rms}\PY{p}{,}\PY{n}{bandwidth}\PY{p}{,}\PY{n}{seed}\PY{p}{,}\PY{l+s}{\PYZsq{}}\PY{l+s}{gaussian}\PY{l+s}{\PYZsq{}}\PY{p}{)}
                  \PY{n}{x\PYZus{}w\PYZus{}list}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{abs}\PY{p}{(}\PY{n}{x\PYZus{}wi}\PY{p}{)}\PY{p}{)}
              \PY{n}{x\PYZus{}w\PYZus{}avg}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{average}\PY{p}{(}\PY{n}{x\PYZus{}w\PYZus{}list}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
              \PY{n}{w\PYZus{}vals}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{fft}\PY{o}{.}\PY{n}{fftfreq}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{x\PYZus{}w\PYZus{}avg}\PY{p}{)}\PY{p}{)}\PY{o}{*}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{pi}\PY{o}{/}\PY{n}{dt}
              \PY{n}{w\PYZus{}limit}\PY{o}{=}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{pi}\PY{o}{*}\PY{n}{bandwidth}
          
              \PY{n}{fig}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{16}\PY{p}{,}\PY{l+m+mi}{8}\PY{p}{)}\PY{p}{)}
              \PY{n}{ax}\PY{o}{=}\PY{n}{fig}\PY{o}{.}\PY{n}{add\PYZus{}subplot}\PY{p}{(}\PY{l+m+mi}{111}\PY{p}{)}
              \PY{n}{ax}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{sort}\PY{p}{(}\PY{n}{w\PYZus{}vals}\PY{p}{)}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{fft}\PY{o}{.}\PY{n}{fftshift}\PY{p}{(}\PY{n}{x\PYZus{}w\PYZus{}avg}\PY{p}{)}\PY{p}{)}
              \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{\PYZdl{}}\PY{l+s}{\PYZbs{}}\PY{l+s}{omega\PYZdl{}}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{\PYZdl{}|X(}\PY{l+s}{\PYZbs{}}\PY{l+s}{omega)|\PYZdl{}}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlim}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{w\PYZus{}limit}\PY{o}{*}\PY{l+m+mi}{3}\PY{p}{,} \PY{n}{w\PYZus{}limit}\PY{o}{*}\PY{l+m+mi}{3}\PY{p}{)}
              \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
              
          \PY{n}{one\PYZus{}pt\PYZus{}two\PYZus{}b}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{SYDE 556-750 Assignment 2_files/SYDE 556-750 Assignment 2_12_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subsection{2) Simulating a Spiking
Neuron}\label{simulating-a-spiking-neuron}

Write a program to simulate a single Leaky-Integrate and Fire neuron.
The core equation is $\frac{dV}{dT}= \frac{1}{\tau_{RC}} (J - V)$ (to
simplify life, this is normalized so that $R$=1, the resting voltage is
0 and the firing voltage is 1). This equation can be simulated
numerically by taking small time steps (Euler's method). When the
voltage reaches the threshold $1$, the neuron will spike and then reset
its voltage to $0$ for the next $\tau_{ref}$ amount of time. Also, if
the voltage goes below zero at any time, reset it back to zero. For this
question, $\tau_{RC}$=0.02 and $\tau_{ref}$=0.002 Since we want to do
inputs in terms of $x$, we need to do $J = \alpha e \cdot x + J^{bias}$.
For this neuron, set $e$ to $+1$ and find $\alpha$ and $J^{bias}$ such
that the firing rate when $x=0$ is 40Hz and when $x=1$ it is 150Hz. To
find these $\alpha$ and $J^{bias}$ values, use the approximation for the
LIF neuron $a(J)=\frac{1} {\tau_{ref}-\tau_{RC}ln(1-\frac{1}{J})}$.

    \paragraph{2a Plot the spike output for a constant input of $x=0$ over 1
second. Report the number of spikes. Do the same thing for $x=1$. Use
\texttt{dt}=0.001 for the
simulation.}\label{a-plot-the-spike-output-for-a-constant-input-of-x0-over-1-second.-report-the-number-of-spikes.-do-the-same-thing-for-x1.-use-dt0.001-for-the-simulation.}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}124}]:} \PY{k}{def} \PY{n+nf}{two\PYZus{}a}\PY{p}{(}\PY{p}{)}\PY{p}{:}
          
              \PY{n}{x1}\PY{o}{=}\PY{l+m+mi}{0}
              \PY{n}{x2}\PY{o}{=}\PY{l+m+mi}{1}
              \PY{n}{a1}\PY{o}{=}\PY{l+m+mi}{40}
              \PY{n}{a2}\PY{o}{=}\PY{l+m+mi}{150}
              \PY{n}{encoder}\PY{o}{=}\PY{l+m+mi}{1}
              \PY{n}{tau\PYZus{}ref}\PY{o}{=}\PY{l+m+mf}{0.002}
              \PY{n}{tau\PYZus{}rc}\PY{o}{=}\PY{l+m+mf}{0.02}
              \PY{n}{T}\PY{o}{=}\PY{l+m+mf}{1.0}
              \PY{n}{dt}\PY{o}{=}\PY{l+m+mf}{0.001}
          
              \PY{n}{n1}\PY{o}{=}\PY{n}{spikingLIFneuron}\PY{p}{(}\PY{n}{x1}\PY{p}{,}\PY{n}{x2}\PY{p}{,}\PY{n}{a1}\PY{p}{,}\PY{n}{a2}\PY{p}{,}\PY{n}{encoder}\PY{p}{,}\PY{n}{tau\PYZus{}ref}\PY{p}{,}\PY{n}{tau\PYZus{}rc}\PY{p}{)}  \PY{c}{\PYZsh{}create spiking neurons}
              \PY{n}{stimulus1} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{l+m+mf}{0.0}\PY{p}{,}\PY{l+m+mf}{0.0}\PY{p}{,}\PY{n}{T}\PY{o}{/}\PY{n}{dt}\PY{p}{)}  \PY{c}{\PYZsh{}constant stimulus of zero}
              \PY{n}{n1}\PY{o}{.}\PY{n}{set\PYZus{}spikes}\PY{p}{(}\PY{n}{stimulus1}\PY{p}{,}\PY{n}{T}\PY{p}{,}\PY{n}{dt}\PY{p}{)}  \PY{c}{\PYZsh{}set the spikes of the neuron, given the stimulus}
              \PY{n}{spikes1}\PY{o}{=}\PY{n}{n1}\PY{o}{.}\PY{n}{get\PYZus{}spikes}\PY{p}{(}\PY{p}{)}
              \PY{n}{stimulus2} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{l+m+mf}{1.0}\PY{p}{,}\PY{l+m+mf}{1.0}\PY{p}{,}\PY{n}{T}\PY{o}{/}\PY{n}{dt}\PY{p}{)}  \PY{c}{\PYZsh{}constant stimulus of one}
              \PY{n}{n1}\PY{o}{.}\PY{n}{set\PYZus{}spikes}\PY{p}{(}\PY{n}{stimulus2}\PY{p}{,}\PY{n}{T}\PY{p}{,}\PY{n}{dt}\PY{p}{)}
              \PY{n}{spikes2}\PY{o}{=}\PY{n}{n1}\PY{o}{.}\PY{n}{get\PYZus{}spikes}\PY{p}{(}\PY{p}{)}
          
              \PY{n}{fig}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{16}\PY{p}{,}\PY{l+m+mi}{8}\PY{p}{)}\PY{p}{)}
              \PY{n}{ax}\PY{o}{=}\PY{n}{fig}\PY{o}{.}\PY{n}{add\PYZus{}subplot}\PY{p}{(}\PY{l+m+mi}{111}\PY{p}{)}
              \PY{n}{times}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{T}\PY{p}{,}\PY{n}{dt}\PY{p}{)}
              \PY{n}{ax}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{times}\PY{p}{,}\PY{n}{spikes1}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{b}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s}{ spikes}\PY{l+s}{\PYZsq{}} \PY{o}{\PYZpc{}}\PY{k}{np}.count\PYZus{}nonzero(spikes1))
              \PY{n}{ax}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{times}\PY{p}{,}\PY{n}{spikes2}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{g}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s}{ spikes}\PY{l+s}{\PYZsq{}} \PY{o}{\PYZpc{}}\PY{k}{np}.count\PYZus{}nonzero(spikes2))
              \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{time (s)}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{Voltage}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{n}{legend}\PY{o}{=}\PY{n}{ax}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{loc}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{best}\PY{l+s}{\PYZsq{}}\PY{p}{)} 
              \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
              
          \PY{n}{two\PYZus{}a}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{SYDE 556-750 Assignment 2_files/SYDE 556-750 Assignment 2_15_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \paragraph{2b Does the observed number of spikes in the previous part
match the expected number of spikes for $x=0$ and $x=1$? Why or why not?
What aspects of the simulation would affect this
accuracy?}\label{b-does-the-observed-number-of-spikes-in-the-previous-part-match-the-expected-number-of-spikes-for-x0-and-x1-why-or-why-not-what-aspects-of-the-simulation-would-affect-this-accuracy}

    The number of spikes we expect at $stimulus=0$ is $40Hz$, because this
is the firing rate corresponding to $x(t)=0$ (no external stimulus) that
we originally specified. When $stimulus = 1$, we expect the firing rate
corresponding to $x(t)=1$, which is $143Hz$ when we specified a rate of
$150hz$. Decreasing the timestep $dt$ improves this accuracy (goes to
$149$ with $dt=0.0001$), because Euler's method becomes more exact and
because the refractory period is specified with more precision.

    \paragraph{2c Plot the spike output for $x(t)$ generated using your
function from part 1.1. Use \texttt{T}=1, \texttt{dt}=0.001,
\texttt{rms}=0.5, and \texttt{limit}=30. Overlay on this plot
$x(t)$.}\label{c-plot-the-spike-output-for-xt-generated-using-your-function-from-part-1.1.-use-t1-dt0.001-rms0.5-and-limit30.-overlay-on-this-plot-xt.}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}125}]:} \PY{k}{def} \PY{n+nf}{two\PYZus{}c}\PY{p}{(}\PY{p}{)}\PY{p}{:}
          
              \PY{n}{rms}\PY{o}{=}\PY{l+m+mf}{0.5}
              \PY{n}{limit}\PY{o}{=}\PY{l+m+mi}{30}
              \PY{n}{seed}\PY{o}{=}\PY{l+m+mi}{3}
              \PY{n}{x1}\PY{o}{=}\PY{l+m+mi}{0}
              \PY{n}{x2}\PY{o}{=}\PY{l+m+mi}{1}
              \PY{n}{a1}\PY{o}{=}\PY{l+m+mi}{40}
              \PY{n}{a2}\PY{o}{=}\PY{l+m+mi}{150}
              \PY{n}{encoder}\PY{o}{=}\PY{l+m+mi}{1}
              \PY{n}{tau\PYZus{}ref}\PY{o}{=}\PY{l+m+mf}{0.002}
              \PY{n}{tau\PYZus{}rc}\PY{o}{=}\PY{l+m+mf}{0.02}
              \PY{n}{T}\PY{o}{=}\PY{l+m+mf}{1.0}
              \PY{n}{dt}\PY{o}{=}\PY{l+m+mf}{0.001}
          
              \PY{n}{n1}\PY{o}{=}\PY{n}{spikingLIFneuron}\PY{p}{(}\PY{n}{x1}\PY{p}{,}\PY{n}{x2}\PY{p}{,}\PY{n}{a1}\PY{p}{,}\PY{n}{a2}\PY{p}{,}\PY{n}{encoder}\PY{p}{,}\PY{n}{tau\PYZus{}ref}\PY{p}{,}\PY{n}{tau\PYZus{}rc}\PY{p}{)}
              \PY{n}{t}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{n+nb}{int}\PY{p}{(}\PY{n}{T}\PY{o}{/}\PY{n}{dt}\PY{p}{)}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{*}\PY{n}{dt}
              \PY{n}{x\PYZus{}t}\PY{p}{,} \PY{n}{x\PYZus{}w} \PY{o}{=} \PY{n}{generate\PYZus{}signal}\PY{p}{(}\PY{n}{T}\PY{p}{,}\PY{n}{dt}\PY{p}{,}\PY{n}{rms}\PY{p}{,}\PY{n}{limit}\PY{p}{,}\PY{n}{seed}\PY{p}{,}\PY{l+s}{\PYZsq{}}\PY{l+s}{uniform}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{n}{stimulus3} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{x\PYZus{}t}\PY{p}{)}
              \PY{n}{n1}\PY{o}{.}\PY{n}{set\PYZus{}spikes}\PY{p}{(}\PY{n}{stimulus3}\PY{p}{,}\PY{n}{T}\PY{p}{,}\PY{n}{dt}\PY{p}{)}
              \PY{n}{spikes3}\PY{o}{=}\PY{n}{n1}\PY{o}{.}\PY{n}{get\PYZus{}spikes}\PY{p}{(}\PY{p}{)}
          
              \PY{n}{fig}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{16}\PY{p}{,}\PY{l+m+mi}{8}\PY{p}{)}\PY{p}{)}
              \PY{n}{ax}\PY{o}{=}\PY{n}{fig}\PY{o}{.}\PY{n}{add\PYZus{}subplot}\PY{p}{(}\PY{l+m+mi}{111}\PY{p}{)}
              \PY{n}{times}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{T}\PY{p}{,}\PY{n}{dt}\PY{p}{)}
              \PY{n}{ax}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{t}\PY{p}{,}\PY{n}{x\PYZus{}t}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{\PYZdl{}x(t)\PYZdl{}}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{n}{ax}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{t}\PY{p}{,}\PY{n}{spikes3}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s}{ spikes}\PY{l+s}{\PYZsq{}} \PY{o}{\PYZpc{}}\PY{k}{np}.count\PYZus{}nonzero(spikes3))
              \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{time (s)}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{\PYZdl{}x(t)\PYZdl{}}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{n}{legend}\PY{o}{=}\PY{n}{ax}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{loc}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{best}\PY{l+s}{\PYZsq{}}\PY{p}{)} 
              \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
          
          \PY{n}{two\PYZus{}c}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{SYDE 556-750 Assignment 2_files/SYDE 556-750 Assignment 2_19_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \paragraph{2d Using the same $x(t)$ signal as in part (c), plot the
neuron's voltage over time for the first 0.2 seconds, along with the
spikes over the same
time.}\label{d-using-the-same-xt-signal-as-in-part-c-plot-the-neurons-voltage-over-time-for-the-first-0.2-seconds-along-with-the-spikes-over-the-same-time.}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}126}]:} \PY{k}{def} \PY{n+nf}{two\PYZus{}d}\PY{p}{(}\PY{p}{)}\PY{p}{:}
          
              \PY{n}{rms}\PY{o}{=}\PY{l+m+mf}{0.5}
              \PY{n}{limit}\PY{o}{=}\PY{l+m+mi}{30}
              \PY{n}{seed}\PY{o}{=}\PY{l+m+mi}{3}  \PY{c}{\PYZsh{}same seed as in part (c)}
              \PY{n}{x1}\PY{o}{=}\PY{l+m+mi}{0}
              \PY{n}{x2}\PY{o}{=}\PY{l+m+mi}{1}
              \PY{n}{a1}\PY{o}{=}\PY{l+m+mi}{40}
              \PY{n}{a2}\PY{o}{=}\PY{l+m+mi}{150}
              \PY{n}{encoder}\PY{o}{=}\PY{l+m+mi}{1}
              \PY{n}{tau\PYZus{}ref}\PY{o}{=}\PY{l+m+mf}{0.002}
              \PY{n}{tau\PYZus{}rc}\PY{o}{=}\PY{l+m+mf}{0.02}
              \PY{n}{T}\PY{o}{=}\PY{l+m+mf}{1.0}
              \PY{n}{dt}\PY{o}{=}\PY{l+m+mf}{0.001}
          
              \PY{n}{n1}\PY{o}{=}\PY{n}{spikingLIFneuron}\PY{p}{(}\PY{n}{x1}\PY{p}{,}\PY{n}{x2}\PY{p}{,}\PY{n}{a1}\PY{p}{,}\PY{n}{a2}\PY{p}{,}\PY{n}{encoder}\PY{p}{,}\PY{n}{tau\PYZus{}ref}\PY{p}{,}\PY{n}{tau\PYZus{}rc}\PY{p}{)}
              \PY{n}{t}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{n+nb}{int}\PY{p}{(}\PY{n}{T}\PY{o}{/}\PY{n}{dt}\PY{p}{)}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{*}\PY{n}{dt}
              \PY{n}{x\PYZus{}t}\PY{p}{,} \PY{n}{x\PYZus{}w} \PY{o}{=} \PY{n}{generate\PYZus{}signal}\PY{p}{(}\PY{n}{T}\PY{p}{,}\PY{n}{dt}\PY{p}{,}\PY{n}{rms}\PY{p}{,}\PY{n}{limit}\PY{p}{,}\PY{n}{seed}\PY{p}{,}\PY{l+s}{\PYZsq{}}\PY{l+s}{uniform}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{n}{stimulus3} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{x\PYZus{}t}\PY{p}{)}
              \PY{n}{n1}\PY{o}{.}\PY{n}{set\PYZus{}spikes}\PY{p}{(}\PY{n}{stimulus3}\PY{p}{,}\PY{n}{T}\PY{p}{,}\PY{n}{dt}\PY{p}{)}
              \PY{n}{spikes3}\PY{o}{=}\PY{n}{n1}\PY{o}{.}\PY{n}{get\PYZus{}spikes}\PY{p}{(}\PY{p}{)}
          
              \PY{n}{fig}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{16}\PY{p}{,}\PY{l+m+mi}{8}\PY{p}{)}\PY{p}{)}
              \PY{n}{ax}\PY{o}{=}\PY{n}{fig}\PY{o}{.}\PY{n}{add\PYZus{}subplot}\PY{p}{(}\PY{l+m+mi}{111}\PY{p}{)}
              \PY{n}{times}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{T}\PY{p}{,}\PY{n}{dt}\PY{p}{)}
              \PY{n}{ax}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{t}\PY{p}{,}\PY{n}{x\PYZus{}t}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{\PYZdl{}x(t)\PYZdl{}}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{n}{ax}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{t}\PY{p}{,}\PY{n}{spikes3}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{spikes}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{n}{ax}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{t}\PY{p}{,}\PY{n}{n1}\PY{o}{.}\PY{n}{Vhistory}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{Voltage}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{time (s)}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{Value}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlim}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mf}{0.2}\PY{p}{)}
              \PY{n}{legend}\PY{o}{=}\PY{n}{ax}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{loc}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{best}\PY{l+s}{\PYZsq{}}\PY{p}{)} 
              \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
              
          \PY{n}{two\PYZus{}d}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{SYDE 556-750 Assignment 2_files/SYDE 556-750 Assignment 2_21_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \paragraph{2.BONUS: How could you improve this simulation (in terms of
how closely the model matches actual equation) without significantly
increasing the computation time? 0.5 marks for having a good idea, and
up to 1 marks for actually implementing it and showing that it
works.}\label{bonus-how-could-you-improve-this-simulation-in-terms-of-how-closely-the-model-matches-actual-equation-without-significantly-increasing-the-computation-time-0.5-marks-for-having-a-good-idea-and-up-to-1-marks-for-actually-implementing-it-and-showing-that-it-works.}

    First, you could increase the accuracy of the spike timing by
implementing a better ODE solver for voltage in the LIF equation. Rather
than using Euler's method to calculate $V(t)$ based on the first order
approximation $dV/dt$, you could use a dedicated solved like 4th/5th
order Runge-Kutta, which is the standard for libraries like
scipy.integrate. Similarly, you could implement an adaptive stepsize, to
capture rapid changes in $x(t)$ without making $dt$ smaller for the
entire $T$ and significantly increases computation time.

Second, you could use SVD to calculate the direction(s) of greatest
variation within $x(t)$, then set the encoders along this direction
(preferably at least one positive and negative). This would ensure that
the spike rate of this neuron is highly correlated with changes in the
signal, though it wouldn't have much effect in the 1D case.

Third, you could use a different basis function for the neuron tuning
curves which better matched the statistics of the signal. Because this
signal is derived from a fourier transformation, you could use a basis
of sines and cosines with different natural frequencies and amplitudes,
as in Georgeopolous or the notes from ``Lecture 6 - Decoder Analysis''.

    \subsection{3) Simulating Two Spiking
Neurons}\label{simulating-two-spiking-neurons}

Write a program that simulates two neurons. The two neurons have exactly
the same parameters, except for one of them $e=1$ and for the other
$e=-1$. Other than that, use exactly the same settings as in question 2.

    \paragraph{3a Plot $x(t)$ and the spiking output for $x(t)=0$ (both
neurons should spike at \textasciitilde{}40 spikes per
second)}\label{a-plot-xt-and-the-spiking-output-for-xt0-both-neurons-should-spike-at-40-spikes-per-second}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}127}]:} \PY{k}{def} \PY{n+nf}{three\PYZus{}a}\PY{p}{(}\PY{p}{)}\PY{p}{:}
          
              \PY{n}{x1}\PY{o}{=}\PY{l+m+mi}{0}
              \PY{n}{x2}\PY{o}{=}\PY{l+m+mi}{1}
              \PY{n}{a1}\PY{o}{=}\PY{l+m+mi}{40}
              \PY{n}{a2}\PY{o}{=}\PY{l+m+mi}{150}
              \PY{n}{e1}\PY{o}{=}\PY{l+m+mi}{1}
              \PY{n}{e2}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}
              \PY{n}{tau\PYZus{}ref}\PY{o}{=}\PY{l+m+mf}{0.002}
              \PY{n}{tau\PYZus{}rc}\PY{o}{=}\PY{l+m+mf}{0.02}
              \PY{n}{T}\PY{o}{=}\PY{l+m+mi}{1}
              \PY{n}{dt}\PY{o}{=}\PY{l+m+mf}{0.001}
              \PY{n}{rms}\PY{o}{=}\PY{l+m+mf}{0.5}
              \PY{n}{limit}\PY{o}{=}\PY{l+m+mi}{30}
              \PY{n}{seed}\PY{o}{=}\PY{l+m+mi}{3}
          
              \PY{c}{\PYZsh{}I calculate alpha and Jbias when I initialize the neurons.}
              \PY{c}{\PYZsh{}To do so, I pass the activity a\PYZus{}i corresponding to x\PYZus{}i dot e}
              \PY{c}{\PYZsh{}The \PYZdq{}off\PYZdq{} neuron with e=\PYZhy{}1 should increase its firing rate as a\PYZus{}i}
              \PY{c}{\PYZsh{}x\PYZus{}i decreases, so I pass in x\PYZus{}1=\PYZhy{}1 =\PYZgt{} x\PYZus{}1 dot e = 1, a\PYZus{}1=150 }
              \PY{n}{x1\PYZus{}dot\PYZus{}e1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{x1}\PY{p}{,}\PY{n}{e1}\PY{p}{)}
              \PY{n}{x2\PYZus{}dot\PYZus{}e1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{x2}\PY{p}{,}\PY{n}{e1}\PY{p}{)}
              \PY{n}{x1\PYZus{}dot\PYZus{}e2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{x1}\PY{p}{,}\PY{n}{e2}\PY{p}{)}
              \PY{n}{x2\PYZus{}dot\PYZus{}e2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{x2}\PY{p}{,}\PY{n}{e2}\PY{p}{)}
              \PY{n}{n1}\PY{o}{=}\PY{n}{spikingLIFneuron}\PY{p}{(}\PY{n}{x1\PYZus{}dot\PYZus{}e1}\PY{p}{,}\PY{n}{x2\PYZus{}dot\PYZus{}e1}\PY{p}{,}\PY{n}{a1}\PY{p}{,}\PY{n}{a2}\PY{p}{,}\PY{n}{e1}\PY{p}{,}\PY{n}{tau\PYZus{}ref}\PY{p}{,}\PY{n}{tau\PYZus{}rc}\PY{p}{)}
              \PY{n}{n2}\PY{o}{=}\PY{n}{spikingLIFneuron}\PY{p}{(}\PY{n}{x1\PYZus{}dot\PYZus{}e2}\PY{p}{,}\PY{n}{x2\PYZus{}dot\PYZus{}e2}\PY{p}{,}\PY{n}{a1}\PY{p}{,}\PY{n}{a2}\PY{p}{,}\PY{n}{e2}\PY{p}{,}\PY{n}{tau\PYZus{}ref}\PY{p}{,}\PY{n}{tau\PYZus{}rc}\PY{p}{)}
              \PY{n}{t}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{n+nb}{int}\PY{p}{(}\PY{n}{T}\PY{o}{/}\PY{n}{dt}\PY{p}{)}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{*}\PY{n}{dt}
              \PY{n}{stimulus1} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{T}\PY{o}{/}\PY{n}{dt}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{)}  \PY{c}{\PYZsh{}constant stimulus of zero}
              \PY{n}{n1}\PY{o}{.}\PY{n}{set\PYZus{}spikes}\PY{p}{(}\PY{n}{stimulus1}\PY{p}{,}\PY{n}{T}\PY{p}{,}\PY{n}{dt}\PY{p}{)}
              \PY{n}{n2}\PY{o}{.}\PY{n}{set\PYZus{}spikes}\PY{p}{(}\PY{n}{stimulus1}\PY{p}{,}\PY{n}{T}\PY{p}{,}\PY{n}{dt}\PY{p}{)}
              \PY{n}{spikes1}\PY{o}{=}\PY{n}{n1}\PY{o}{.}\PY{n}{get\PYZus{}spikes}\PY{p}{(}\PY{p}{)}
              \PY{n}{spikes2}\PY{o}{=}\PY{n}{n2}\PY{o}{.}\PY{n}{get\PYZus{}spikes}\PY{p}{(}\PY{p}{)}
          
              \PY{n}{fig}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{16}\PY{p}{,}\PY{l+m+mi}{8}\PY{p}{)}\PY{p}{)}
              \PY{n}{ax}\PY{o}{=}\PY{n}{fig}\PY{o}{.}\PY{n}{add\PYZus{}subplot}\PY{p}{(}\PY{l+m+mi}{111}\PY{p}{)}
              \PY{n}{ax}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{t}\PY{p}{,}\PY{n}{stimulus1}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{\PYZdl{}x(t)=0\PYZdl{}}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{n}{ax}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{t}\PY{p}{,}\PY{n}{spikes1}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s}{ spikes, \PYZdl{}e=1\PYZdl{}}\PY{l+s}{\PYZsq{}} \PY{o}{\PYZpc{}}\PY{k}{np}.count\PYZus{}nonzero(spikes1))
              \PY{c}{\PYZsh{}\PYZdq{}off\PYZdq{} neuron spikes go in opposite direction}
              \PY{n}{ax}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{t}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{spikes2}\PY{p}{)}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s}{ spikes, \PYZdl{}e=\PYZhy{}1\PYZdl{}}\PY{l+s}{\PYZsq{}}
                      \PY{o}{\PYZpc{}}\PY{k}{np}.count\PYZus{}nonzero(spikes2))
              \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{time (s)}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{Voltage}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlim}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{T}\PY{p}{)}
              \PY{n}{legend}\PY{o}{=}\PY{n}{ax}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{loc}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{best}\PY{l+s}{\PYZsq{}}\PY{p}{)} 
              \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
              
          \PY{n}{three\PYZus{}a}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{SYDE 556-750 Assignment 2_files/SYDE 556-750 Assignment 2_26_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \paragraph{3b Plot $x(t)$ and the spiking output for $x(t)=1$ (one
neuron should spike at \textasciitilde{}150 spikes per second, and the
other should not spike at
all)}\label{b-plot-xt-and-the-spiking-output-for-xt1-one-neuron-should-spike-at-150-spikes-per-second-and-the-other-should-not-spike-at-all}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}128}]:} \PY{k}{def} \PY{n+nf}{three\PYZus{}b}\PY{p}{(}\PY{p}{)}\PY{p}{:}
          
              \PY{n}{x1}\PY{o}{=}\PY{l+m+mi}{0}
              \PY{n}{x2}\PY{o}{=}\PY{l+m+mi}{1}
              \PY{n}{a1}\PY{o}{=}\PY{l+m+mi}{40}
              \PY{n}{a2}\PY{o}{=}\PY{l+m+mi}{150}
              \PY{n}{e1}\PY{o}{=}\PY{l+m+mi}{1}
              \PY{n}{e2}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}
              \PY{n}{tau\PYZus{}ref}\PY{o}{=}\PY{l+m+mf}{0.002}
              \PY{n}{tau\PYZus{}rc}\PY{o}{=}\PY{l+m+mf}{0.02}
              \PY{n}{T}\PY{o}{=}\PY{l+m+mi}{1}
              \PY{n}{dt}\PY{o}{=}\PY{l+m+mf}{0.001}
              \PY{n}{rms}\PY{o}{=}\PY{l+m+mf}{0.5}
              \PY{n}{limit}\PY{o}{=}\PY{l+m+mi}{30}
              \PY{n}{seed}\PY{o}{=}\PY{l+m+mi}{3}
          
              \PY{n}{x1\PYZus{}dot\PYZus{}e1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{x1}\PY{p}{,}\PY{n}{e1}\PY{p}{)}
              \PY{n}{x2\PYZus{}dot\PYZus{}e1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{x2}\PY{p}{,}\PY{n}{e1}\PY{p}{)}
              \PY{n}{x1\PYZus{}dot\PYZus{}e2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{x1}\PY{p}{,}\PY{n}{e2}\PY{p}{)}
              \PY{n}{x2\PYZus{}dot\PYZus{}e2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{x2}\PY{p}{,}\PY{n}{e2}\PY{p}{)}
              \PY{n}{n1}\PY{o}{=}\PY{n}{spikingLIFneuron}\PY{p}{(}\PY{n}{x1\PYZus{}dot\PYZus{}e1}\PY{p}{,}\PY{n}{x2\PYZus{}dot\PYZus{}e1}\PY{p}{,}\PY{n}{a1}\PY{p}{,}\PY{n}{a2}\PY{p}{,}\PY{n}{e1}\PY{p}{,}\PY{n}{tau\PYZus{}ref}\PY{p}{,}\PY{n}{tau\PYZus{}rc}\PY{p}{)}
              \PY{n}{n2}\PY{o}{=}\PY{n}{spikingLIFneuron}\PY{p}{(}\PY{n}{x1\PYZus{}dot\PYZus{}e2}\PY{p}{,}\PY{n}{x2\PYZus{}dot\PYZus{}e2}\PY{p}{,}\PY{n}{a1}\PY{p}{,}\PY{n}{a2}\PY{p}{,}\PY{n}{e2}\PY{p}{,}\PY{n}{tau\PYZus{}ref}\PY{p}{,}\PY{n}{tau\PYZus{}rc}\PY{p}{)}
              \PY{n}{t}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{n+nb}{int}\PY{p}{(}\PY{n}{T}\PY{o}{/}\PY{n}{dt}\PY{p}{)}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{*}\PY{n}{dt}
              \PY{n}{stimulus2} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{T}\PY{o}{/}\PY{n}{dt}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{)}
              \PY{n}{n1}\PY{o}{.}\PY{n}{set\PYZus{}spikes}\PY{p}{(}\PY{n}{stimulus2}\PY{p}{,}\PY{n}{T}\PY{p}{,}\PY{n}{dt}\PY{p}{)}
              \PY{n}{n2}\PY{o}{.}\PY{n}{set\PYZus{}spikes}\PY{p}{(}\PY{n}{stimulus2}\PY{p}{,}\PY{n}{T}\PY{p}{,}\PY{n}{dt}\PY{p}{)}
              \PY{n}{spikes1}\PY{o}{=}\PY{n}{n1}\PY{o}{.}\PY{n}{get\PYZus{}spikes}\PY{p}{(}\PY{p}{)}
              \PY{n}{spikes2}\PY{o}{=}\PY{n}{n2}\PY{o}{.}\PY{n}{get\PYZus{}spikes}\PY{p}{(}\PY{p}{)}
          
              \PY{n}{fig}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{16}\PY{p}{,}\PY{l+m+mi}{8}\PY{p}{)}\PY{p}{)}
              \PY{n}{ax}\PY{o}{=}\PY{n}{fig}\PY{o}{.}\PY{n}{add\PYZus{}subplot}\PY{p}{(}\PY{l+m+mi}{111}\PY{p}{)}
              \PY{n}{ax}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{t}\PY{p}{,}\PY{n}{stimulus2}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{\PYZdl{}x(t)=1\PYZdl{}}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{n}{ax}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{t}\PY{p}{,}\PY{n}{spikes1}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s}{ spikes, \PYZdl{}e=1\PYZdl{}}\PY{l+s}{\PYZsq{}} \PY{o}{\PYZpc{}}\PY{k}{np}.count\PYZus{}nonzero(spikes1))
              \PY{n}{ax}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{t}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{spikes2}\PY{p}{)}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s}{ spikes, \PYZdl{}e=\PYZhy{}1\PYZdl{}}\PY{l+s}{\PYZsq{}} 
                      \PY{o}{\PYZpc{}}\PY{k}{np}.count\PYZus{}nonzero(spikes2))
              \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{time (s)}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{Voltage}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlim}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{T}\PY{p}{)}
              \PY{c}{\PYZsh{} ax.set\PYZus{}ylim(0,2)}
              \PY{n}{legend}\PY{o}{=}\PY{n}{ax}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{loc}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{best}\PY{l+s}{\PYZsq{}}\PY{p}{)} 
              \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
              
          \PY{n}{three\PYZus{}b}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{SYDE 556-750 Assignment 2_files/SYDE 556-750 Assignment 2_28_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \paragraph{3c Plot $x(t)$ and the spiking output for
$x(t)={1 \over 2}sin(10\pi t)$ (a sine wave at
5Hz).}\label{c-plot-xt-and-the-spiking-output-for-xt1-over-2sin10pi-t-a-sine-wave-at-5hz.}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}129}]:} \PY{k}{def} \PY{n+nf}{three\PYZus{}c}\PY{p}{(}\PY{p}{)}\PY{p}{:}
          
              \PY{n}{x1}\PY{o}{=}\PY{l+m+mi}{0}
              \PY{n}{x2}\PY{o}{=}\PY{l+m+mi}{1}
              \PY{n}{a1}\PY{o}{=}\PY{l+m+mi}{40}
              \PY{n}{a2}\PY{o}{=}\PY{l+m+mi}{150}
              \PY{n}{e1}\PY{o}{=}\PY{l+m+mi}{1}
              \PY{n}{e2}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}
              \PY{n}{tau\PYZus{}ref}\PY{o}{=}\PY{l+m+mf}{0.002}
              \PY{n}{tau\PYZus{}rc}\PY{o}{=}\PY{l+m+mf}{0.02}
              \PY{n}{T}\PY{o}{=}\PY{l+m+mi}{1}
              \PY{n}{dt}\PY{o}{=}\PY{l+m+mf}{0.001}
              \PY{n}{rms}\PY{o}{=}\PY{l+m+mf}{0.5}
              \PY{n}{limit}\PY{o}{=}\PY{l+m+mi}{30}
              \PY{n}{seed}\PY{o}{=}\PY{l+m+mi}{3}
          
              \PY{n}{x1\PYZus{}dot\PYZus{}e1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{x1}\PY{p}{,}\PY{n}{e1}\PY{p}{)}
              \PY{n}{x2\PYZus{}dot\PYZus{}e1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{x2}\PY{p}{,}\PY{n}{e1}\PY{p}{)}
              \PY{n}{x1\PYZus{}dot\PYZus{}e2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{x1}\PY{p}{,}\PY{n}{e2}\PY{p}{)}
              \PY{n}{x2\PYZus{}dot\PYZus{}e2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{x2}\PY{p}{,}\PY{n}{e2}\PY{p}{)}
              \PY{n}{n1}\PY{o}{=}\PY{n}{spikingLIFneuron}\PY{p}{(}\PY{n}{x1\PYZus{}dot\PYZus{}e1}\PY{p}{,}\PY{n}{x2\PYZus{}dot\PYZus{}e1}\PY{p}{,}\PY{n}{a1}\PY{p}{,}\PY{n}{a2}\PY{p}{,}\PY{n}{e1}\PY{p}{,}\PY{n}{tau\PYZus{}ref}\PY{p}{,}\PY{n}{tau\PYZus{}rc}\PY{p}{)}
              \PY{n}{n2}\PY{o}{=}\PY{n}{spikingLIFneuron}\PY{p}{(}\PY{n}{x1\PYZus{}dot\PYZus{}e2}\PY{p}{,}\PY{n}{x2\PYZus{}dot\PYZus{}e2}\PY{p}{,}\PY{n}{a1}\PY{p}{,}\PY{n}{a2}\PY{p}{,}\PY{n}{e2}\PY{p}{,}\PY{n}{tau\PYZus{}ref}\PY{p}{,}\PY{n}{tau\PYZus{}rc}\PY{p}{)}
              \PY{n}{t}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{n+nb}{int}\PY{p}{(}\PY{n}{T}\PY{o}{/}\PY{n}{dt}\PY{p}{)}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{*}\PY{n}{dt}
              \PY{n}{stimulus3} \PY{o}{=} \PY{l+m+mf}{0.5}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{sin}\PY{p}{(}\PY{l+m+mi}{10}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{pi}\PY{o}{*}\PY{n}{t}\PY{p}{)}
              \PY{n}{n1}\PY{o}{.}\PY{n}{set\PYZus{}spikes}\PY{p}{(}\PY{n}{stimulus3}\PY{p}{,}\PY{n}{T}\PY{p}{,}\PY{n}{dt}\PY{p}{)}
              \PY{n}{n2}\PY{o}{.}\PY{n}{set\PYZus{}spikes}\PY{p}{(}\PY{n}{stimulus3}\PY{p}{,}\PY{n}{T}\PY{p}{,}\PY{n}{dt}\PY{p}{)}
              \PY{n}{spikes1}\PY{o}{=}\PY{n}{n1}\PY{o}{.}\PY{n}{get\PYZus{}spikes}\PY{p}{(}\PY{p}{)}
              \PY{n}{spikes2}\PY{o}{=}\PY{n}{n2}\PY{o}{.}\PY{n}{get\PYZus{}spikes}\PY{p}{(}\PY{p}{)}
          
              \PY{n}{fig}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{16}\PY{p}{,}\PY{l+m+mi}{8}\PY{p}{)}\PY{p}{)}
              \PY{n}{ax}\PY{o}{=}\PY{n}{fig}\PY{o}{.}\PY{n}{add\PYZus{}subplot}\PY{p}{(}\PY{l+m+mi}{111}\PY{p}{)}
              \PY{n}{ax}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{t}\PY{p}{,}\PY{n}{stimulus3}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{\PYZdl{}x(t)=0.5 sin(10 }\PY{l+s}{\PYZbs{}}\PY{l+s}{omega t)\PYZdl{}}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{n}{ax}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{t}\PY{p}{,}\PY{n}{spikes1}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s}{ spikes, \PYZdl{}e=1\PYZdl{}}\PY{l+s}{\PYZsq{}} \PY{o}{\PYZpc{}}\PY{k}{np}.count\PYZus{}nonzero(spikes1))
              \PY{n}{ax}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{t}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{spikes2}\PY{p}{)}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s}{ spikes, \PYZdl{}e=\PYZhy{}1\PYZdl{}}\PY{l+s}{\PYZsq{}} 
                      \PY{o}{\PYZpc{}}\PY{k}{np}.count\PYZus{}nonzero(spikes2))
              \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{time (s)}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{Voltage}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlim}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{T}\PY{p}{)}
              \PY{n}{legend}\PY{o}{=}\PY{n}{ax}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{loc}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{best}\PY{l+s}{\PYZsq{}}\PY{p}{)} 
              \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
              
          \PY{n}{three\PYZus{}c}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{SYDE 556-750 Assignment 2_files/SYDE 556-750 Assignment 2_30_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \paragraph{3d Plot $x(t)$ and the spiking output for a random signal
generated with your function for question 1.1 with \texttt{T}=2,
\texttt{dt}=0.001, \texttt{rms}=0.5, and
\texttt{limit}=5.}\label{d-plot-xt-and-the-spiking-output-for-a-random-signal-generated-with-your-function-for-question-1.1-with-t2-dt0.001-rms0.5-and-limit5.}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}130}]:} \PY{k}{def} \PY{n+nf}{three\PYZus{}d}\PY{p}{(}\PY{p}{)}\PY{p}{:}
          
              \PY{n}{x1}\PY{o}{=}\PY{l+m+mi}{0}
              \PY{n}{x2}\PY{o}{=}\PY{l+m+mi}{1}
              \PY{n}{a1}\PY{o}{=}\PY{l+m+mi}{40}
              \PY{n}{a2}\PY{o}{=}\PY{l+m+mi}{150}
              \PY{n}{e1}\PY{o}{=}\PY{l+m+mi}{1}
              \PY{n}{e2}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}
              \PY{n}{tau\PYZus{}ref}\PY{o}{=}\PY{l+m+mf}{0.002}
              \PY{n}{tau\PYZus{}rc}\PY{o}{=}\PY{l+m+mf}{0.02}
              \PY{n}{T}\PY{o}{=}\PY{l+m+mi}{1}
              \PY{n}{dt}\PY{o}{=}\PY{l+m+mf}{0.001}
              \PY{n}{rms}\PY{o}{=}\PY{l+m+mf}{0.5}
              \PY{n}{limit}\PY{o}{=}\PY{l+m+mi}{30}
              \PY{n}{seed}\PY{o}{=}\PY{l+m+mi}{3}
          
              \PY{n}{x1\PYZus{}dot\PYZus{}e1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{x1}\PY{p}{,}\PY{n}{e1}\PY{p}{)}
              \PY{n}{x2\PYZus{}dot\PYZus{}e1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{x2}\PY{p}{,}\PY{n}{e1}\PY{p}{)}
              \PY{n}{x1\PYZus{}dot\PYZus{}e2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{x1}\PY{p}{,}\PY{n}{e2}\PY{p}{)}
              \PY{n}{x2\PYZus{}dot\PYZus{}e2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{x2}\PY{p}{,}\PY{n}{e2}\PY{p}{)}
              \PY{n}{n1}\PY{o}{=}\PY{n}{spikingLIFneuron}\PY{p}{(}\PY{n}{x1\PYZus{}dot\PYZus{}e1}\PY{p}{,}\PY{n}{x2\PYZus{}dot\PYZus{}e1}\PY{p}{,}\PY{n}{a1}\PY{p}{,}\PY{n}{a2}\PY{p}{,}\PY{n}{e1}\PY{p}{,}\PY{n}{tau\PYZus{}ref}\PY{p}{,}\PY{n}{tau\PYZus{}rc}\PY{p}{)}
              \PY{n}{n2}\PY{o}{=}\PY{n}{spikingLIFneuron}\PY{p}{(}\PY{n}{x1\PYZus{}dot\PYZus{}e2}\PY{p}{,}\PY{n}{x2\PYZus{}dot\PYZus{}e2}\PY{p}{,}\PY{n}{a1}\PY{p}{,}\PY{n}{a2}\PY{p}{,}\PY{n}{e2}\PY{p}{,}\PY{n}{tau\PYZus{}ref}\PY{p}{,}\PY{n}{tau\PYZus{}rc}\PY{p}{)}
              \PY{n}{t}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{n+nb}{int}\PY{p}{(}\PY{n}{T}\PY{o}{/}\PY{n}{dt}\PY{p}{)}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{*}\PY{n}{dt}
              \PY{n}{x\PYZus{}t}\PY{p}{,} \PY{n}{x\PYZus{}w} \PY{o}{=} \PY{n}{generate\PYZus{}signal}\PY{p}{(}\PY{n}{T}\PY{p}{,}\PY{n}{dt}\PY{p}{,}\PY{n}{rms}\PY{p}{,}\PY{n}{limit}\PY{p}{,}\PY{n}{seed}\PY{p}{,}\PY{l+s}{\PYZsq{}}\PY{l+s}{uniform}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{n}{stimulus4} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{x\PYZus{}t}\PY{p}{)}
              \PY{n}{n1}\PY{o}{.}\PY{n}{set\PYZus{}spikes}\PY{p}{(}\PY{n}{stimulus4}\PY{p}{,}\PY{n}{T}\PY{p}{,}\PY{n}{dt}\PY{p}{)}
              \PY{n}{n2}\PY{o}{.}\PY{n}{set\PYZus{}spikes}\PY{p}{(}\PY{n}{stimulus4}\PY{p}{,}\PY{n}{T}\PY{p}{,}\PY{n}{dt}\PY{p}{)}
              \PY{n}{spikes1}\PY{o}{=}\PY{n}{n1}\PY{o}{.}\PY{n}{get\PYZus{}spikes}\PY{p}{(}\PY{p}{)}
              \PY{n}{spikes2}\PY{o}{=}\PY{n}{n2}\PY{o}{.}\PY{n}{get\PYZus{}spikes}\PY{p}{(}\PY{p}{)}
          
              \PY{n}{fig}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{16}\PY{p}{,}\PY{l+m+mi}{8}\PY{p}{)}\PY{p}{)}
              \PY{n}{ax}\PY{o}{=}\PY{n}{fig}\PY{o}{.}\PY{n}{add\PYZus{}subplot}\PY{p}{(}\PY{l+m+mi}{111}\PY{p}{)}
              \PY{n}{ax}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{t}\PY{p}{,}\PY{n}{stimulus4}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{\PYZdl{}x(t)\PYZdl{} = smoothed white noise}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{n}{ax}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{t}\PY{p}{,}\PY{n}{spikes1}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s}{ spikes, \PYZdl{}e=1\PYZdl{}}\PY{l+s}{\PYZsq{}} \PY{o}{\PYZpc{}}\PY{k}{np}.count\PYZus{}nonzero(spikes1))
              \PY{n}{ax}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{t}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{spikes2}\PY{p}{)}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s}{ spikes, \PYZdl{}e=\PYZhy{}1\PYZdl{}}\PY{l+s}{\PYZsq{}}
                      \PY{o}{\PYZpc{}}\PY{k}{np}.count\PYZus{}nonzero(spikes2))
              \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{time (s)}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{Voltage}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlim}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{T}\PY{p}{)}
              \PY{n}{legend}\PY{o}{=}\PY{n}{ax}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{loc}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{best}\PY{l+s}{\PYZsq{}}\PY{p}{)} 
              \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}    
              
          \PY{n}{three\PYZus{}d}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{SYDE 556-750 Assignment 2_files/SYDE 556-750 Assignment 2_32_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subsection{4) Computing an Optimal
Filter}\label{computing-an-optimal-filter}

Compute the optimal filter for decoding pairs of spikes. Instead of
implementing this yourself, here is an implementation in Python and an
implementation in Matlab.

    \paragraph{4a-d}\label{a-d}

Document the code and connect it with the code you wrote for part (3) so
that it uses the signal used in 3.d. Comments should be filled in where
there are \texttt{\#} signs (Python) or \texttt{\%} signs (Matlab).
Replace the \texttt{'???'} labels in the code with the correct labels.

Plot the time and frequency plots for the optimal filter for the signal
you generated in question 3.d.

Plot the $x(t)$ signal, the spikes, and the decoded $\hat{x}(t)$ value
for the signal in question 3.d.

Plot the $|X(\omega)|$ power spectrum, $|R(\omega)|$ spike response
spectrum, and the $|\hat{X}(\omega)|$ power spectrum for the signal in
question 3.d. How do these relate to the optimal filter?

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}131}]:} \PY{k}{def} \PY{n+nf}{four\PYZus{}a\PYZus{}thru\PYZus{}d}\PY{p}{(}\PY{p}{)}\PY{p}{:}
          
              \PY{n}{T} \PY{o}{=} \PY{l+m+mf}{2.0}         \PY{c}{\PYZsh{} length of signal in seconds}
              \PY{n}{dt} \PY{o}{=} \PY{l+m+mf}{0.001}      \PY{c}{\PYZsh{} time step size}
              \PY{n}{rms}\PY{o}{=}\PY{l+m+mf}{0.5}
              \PY{n}{limit}\PY{o}{=}\PY{l+m+mi}{5}
              \PY{n}{seed}\PY{o}{=}\PY{l+m+mi}{3}
          
              \PY{c}{\PYZsh{} Generate bandlimited white noise (use your own function from part 1.1)}
              \PY{n}{x\PYZus{}t}\PY{p}{,} \PY{n}{x\PYZus{}w} \PY{o}{=} \PY{n}{generate\PYZus{}signal}\PY{p}{(}\PY{n}{T}\PY{p}{,}\PY{n}{dt}\PY{p}{,}\PY{n}{rms}\PY{p}{,}\PY{n}{limit}\PY{p}{,}\PY{n}{seed}\PY{p}{,}\PY{l+s}{\PYZsq{}}\PY{l+s}{uniform}\PY{l+s}{\PYZsq{}}\PY{p}{)}
          
              \PY{n}{Nt} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{x\PYZus{}t}\PY{p}{)}           \PY{c}{\PYZsh{}length of the returned signal}
              \PY{n}{t} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{n}{Nt}\PY{p}{)} \PY{o}{*} \PY{n}{dt}  \PY{c}{\PYZsh{}time values of the signal}
          
              \PY{c}{\PYZsh{} Neuron parameters}
              \PY{n}{tau\PYZus{}ref} \PY{o}{=} \PY{l+m+mf}{0.002}          \PY{c}{\PYZsh{} refractory period in seconds}
              \PY{n}{tau\PYZus{}rc} \PY{o}{=} \PY{l+m+mf}{0.02}            \PY{c}{\PYZsh{} RC time constant in seconds}
              \PY{n}{x1} \PY{o}{=} \PY{l+m+mf}{0.0}                 \PY{c}{\PYZsh{} firing rate at x=x0 is a0}
              \PY{n}{a1} \PY{o}{=} \PY{l+m+mf}{40.0}
              \PY{n}{x2} \PY{o}{=} \PY{l+m+mf}{1.0}                 \PY{c}{\PYZsh{} firing rate at x=x1 is a1}
              \PY{n}{a2} \PY{o}{=} \PY{l+m+mf}{150.0}
          
              \PY{c}{\PYZsh{}I actually calculate alpha and Jbias when I initialize the neurons,}
              \PY{c}{\PYZsh{}so I\PYZsq{}m leaving out your code}
              \PY{n}{e1}\PY{o}{=}\PY{l+m+mi}{1}
              \PY{n}{e2}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}
              \PY{n}{x1\PYZus{}dot\PYZus{}e1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{x1}\PY{p}{,}\PY{n}{e1}\PY{p}{)}
              \PY{n}{x2\PYZus{}dot\PYZus{}e1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{x2}\PY{p}{,}\PY{n}{e1}\PY{p}{)}
              \PY{n}{x1\PYZus{}dot\PYZus{}e2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{x1}\PY{p}{,}\PY{n}{e2}\PY{p}{)}
              \PY{n}{x2\PYZus{}dot\PYZus{}e2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{x2}\PY{p}{,}\PY{n}{e2}\PY{p}{)}
              \PY{c}{\PYZsh{}create spiking neurons}
              \PY{n}{n1}\PY{o}{=}\PY{n}{spikingLIFneuron}\PY{p}{(}\PY{n}{x1\PYZus{}dot\PYZus{}e1}\PY{p}{,}\PY{n}{x2\PYZus{}dot\PYZus{}e1}\PY{p}{,}\PY{n}{a1}\PY{p}{,}\PY{n}{a2}\PY{p}{,}\PY{n}{e1}\PY{p}{,}\PY{n}{tau\PYZus{}ref}\PY{p}{,}\PY{n}{tau\PYZus{}rc}\PY{p}{)} 
              \PY{n}{n2}\PY{o}{=}\PY{n}{spikingLIFneuron}\PY{p}{(}\PY{n}{x1\PYZus{}dot\PYZus{}e2}\PY{p}{,}\PY{n}{x2\PYZus{}dot\PYZus{}e2}\PY{p}{,}\PY{n}{a1}\PY{p}{,}\PY{n}{a2}\PY{p}{,}\PY{n}{e2}\PY{p}{,}\PY{n}{tau\PYZus{}ref}\PY{p}{,}\PY{n}{tau\PYZus{}rc}\PY{p}{)}
              \PY{c}{\PYZsh{}use the generated white\PYZhy{}noise signal as stimulus}
              \PY{n}{stimulus4} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{x\PYZus{}t}\PY{p}{)}             
              \PY{c}{\PYZsh{}calculate the spikes corresponding to this signal}
              \PY{n}{n1}\PY{o}{.}\PY{n}{set\PYZus{}spikes}\PY{p}{(}\PY{n}{stimulus4}\PY{p}{,}\PY{n}{T}\PY{p}{,}\PY{n}{dt}\PY{p}{)}          
              \PY{n}{n2}\PY{o}{.}\PY{n}{set\PYZus{}spikes}\PY{p}{(}\PY{n}{stimulus4}\PY{p}{,}\PY{n}{T}\PY{p}{,}\PY{n}{dt}\PY{p}{)}
              \PY{c}{\PYZsh{}return the spikes}
              \PY{n}{spikes1}\PY{o}{=}\PY{n}{n1}\PY{o}{.}\PY{n}{get\PYZus{}spikes}\PY{p}{(}\PY{p}{)}               
              \PY{n}{spikes2}\PY{o}{=}\PY{n}{n2}\PY{o}{.}\PY{n}{get\PYZus{}spikes}\PY{p}{(}\PY{p}{)}
              \PY{c}{\PYZsh{}put spikes in the given form}
              \PY{n}{spikes}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{n}{spikes1}\PY{p}{,}\PY{n}{spikes2}\PY{p}{]}\PY{p}{)}    
          
              \PY{c}{\PYZsh{}frequencies in Hz of the signal (\PYZhy{}f\PYZus{}max to +f\PYZus{}max)}
              \PY{n}{freq} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{n}{Nt}\PY{p}{)}\PY{o}{/}\PY{n}{T} \PY{o}{\PYZhy{}} \PY{n}{Nt}\PY{o}{/}\PY{p}{(}\PY{l+m+mf}{2.0}\PY{o}{*}\PY{n}{T}\PY{p}{)}   
              \PY{c}{\PYZsh{}corresponding frequencies in radians (\PYZhy{}w\PYZus{}max to w\PYZus{}max)}
              \PY{n}{omega} \PY{o}{=} \PY{n}{freq}\PY{o}{*}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{pi}                  
          
              \PY{c}{\PYZsh{} the response of the two neurons combined together:}
              \PY{c}{\PYZsh{}nonzero values at each time step when one neuron spiked and the other did not}
              \PY{n}{r} \PY{o}{=} \PY{n}{spikes}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{\PYZhy{}} \PY{n}{spikes}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}               
              \PY{c}{\PYZsh{} translate this response difference into the frequency domain,}
              \PY{c}{\PYZsh{} this will turn convolution into multiplication and represents spike train power}
              \PY{n}{R} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{fft}\PY{o}{.}\PY{n}{fftshift}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{fft}\PY{o}{.}\PY{n}{fft}\PY{p}{(}\PY{n}{r}\PY{p}{)}\PY{p}{)}
              \PY{c}{\PYZsh{} X is frequency domain description of the white noise signal}
              \PY{n}{X}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{fft}\PY{o}{.}\PY{n}{fftshift}\PY{p}{(}\PY{n}{x\PYZus{}w}\PY{p}{)}                                 
          
              \PY{c}{\PYZsh{}width of the gaussian window filter in frequency space}
              \PY{c}{\PYZsh{}sigma\PYZus{}t = 1/tau, so with smaller sigma creates larger temporal windows}
              \PY{n}{sigma\PYZus{}t} \PY{o}{=} \PY{l+m+mf}{0.025}                          
              \PY{c}{\PYZsh{}Gaussian filter, expressing power as a function of the freqency omega}
              \PY{n}{W2} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{exp}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{omega}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{sigma\PYZus{}t}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}     
              \PY{c}{\PYZsh{}Normalize the filter from 0 to 1}
              \PY{n}{W2} \PY{o}{=} \PY{n}{W2} \PY{o}{/} \PY{n+nb}{sum}\PY{p}{(}\PY{n}{W2}\PY{p}{)}                        
                                          
              \PY{c}{\PYZsh{} X(w)*R*(w) represents correlated power between signal and spike train amplitudes}
              \PY{n}{CP} \PY{o}{=} \PY{n}{X}\PY{o}{*}\PY{n}{R}\PY{o}{.}\PY{n}{conjugate}\PY{p}{(}\PY{p}{)}  
              \PY{c}{\PYZsh{} convolve correlated power with the gaussian to perform windowed filtering}
              \PY{n}{WCP} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{convolve}\PY{p}{(}\PY{n}{CP}\PY{p}{,} \PY{n}{W2}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{same}\PY{l+s}{\PYZsq{}}\PY{p}{)}  
              \PY{c}{\PYZsh{} calculate spike train power |R(w\PYZus{}n:A)|\PYZca{}2 =  R * complex conjugate R}
              \PY{n}{RP} \PY{o}{=} \PY{n}{R}\PY{o}{*}\PY{n}{R}\PY{o}{.}\PY{n}{conjugate}\PY{p}{(}\PY{p}{)}
              \PY{c}{\PYZsh{} convolve spike train power with the gaussian to perform windowed filtering}
              \PY{n}{WRP} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{convolve}\PY{p}{(}\PY{n}{RP}\PY{p}{,} \PY{n}{W2}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{same}\PY{l+s}{\PYZsq{}}\PY{p}{)}   
              \PY{c}{\PYZsh{} calculate the signal power spectrum |X(w)|\PYZca{}2 = X * complex congugate X}
              \PY{n}{XP} \PY{o}{=} \PY{n}{X}\PY{o}{*}\PY{n}{X}\PY{o}{.}\PY{n}{conjugate}\PY{p}{(}\PY{p}{)}
              \PY{c}{\PYZsh{}convolve the R(w) values for the neuron pair response with the gaussian filter}
              \PY{c}{\PYZsh{}not used here, but it could be used to calculate the error in frequency domain}
              \PY{n}{WXP} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{convolve}\PY{p}{(}\PY{n}{XP}\PY{p}{,} \PY{n}{W2}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{same}\PY{l+s}{\PYZsq{}}\PY{p}{)}  
              \PY{c}{\PYZsh{}The optimal temporal filter in the frequency domain; equation 4.19 in NEF book}
              \PY{n}{H} \PY{o}{=} \PY{n}{WCP} \PY{o}{/} \PY{n}{WRP}
              \PY{n}{H\PYZus{}unsmoothed} \PY{o}{=} \PY{n}{CP} \PY{o}{/} \PY{n}{RP} \PY{c}{\PYZsh{}for comparison}
          
              \PY{c}{\PYZsh{} bring the optimal temporal filter into the time domain,}
              \PY{c}{\PYZsh{}making sure the frequencies line up properly}
              \PY{n}{h} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{fft}\PY{o}{.}\PY{n}{fftshift}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{fft}\PY{o}{.}\PY{n}{ifft}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{fft}\PY{o}{.}\PY{n}{ifftshift}\PY{p}{(}\PY{n}{H}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{o}{.}\PY{n}{real}  
          
              \PY{c}{\PYZsh{}convolve temporal filter and neuron pair response in the frequency domain,}
              \PY{c}{\PYZsh{}returns the temporally filtered estimate for spiking neurons}
              \PY{n}{XHAT} \PY{o}{=} \PY{n}{H}\PY{o}{*}\PY{n}{R}
              \PY{c}{\PYZsh{}bring the frequency domain state estimate into the time domain}
              \PY{n}{xhat} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{fft}\PY{o}{.}\PY{n}{ifft}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{fft}\PY{o}{.}\PY{n}{ifftshift}\PY{p}{(}\PY{n}{XHAT}\PY{p}{)}\PY{p}{)}\PY{o}{.}\PY{n}{real}
                   
              \PY{c}{\PYZsh{}4b}
              \PY{n}{fig}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{16}\PY{p}{,}\PY{l+m+mi}{8}\PY{p}{)}\PY{p}{)}
              \PY{c}{\PYZsh{} plt.title(\PYZsq{}Optimal Temporal Filter\PYZsq{})}
              \PY{n}{ax}\PY{o}{=}\PY{n}{fig}\PY{o}{.}\PY{n}{add\PYZus{}subplot}\PY{p}{(}\PY{l+m+mi}{121}\PY{p}{)}
              \PY{c}{\PYZsh{}optimal temporal filter power in frequency domain}
              \PY{n}{ax}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{omega}\PY{p}{,}\PY{n}{H}\PY{o}{.}\PY{n}{real}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{gaussian smoothed}\PY{l+s}{\PYZsq{}}\PY{p}{)} 
              \PY{n}{ax}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{omega}\PY{p}{,}\PY{n}{H\PYZus{}unsmoothed}\PY{o}{.}\PY{n}{real}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{unsmoothed}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{\PYZdl{}}\PY{l+s}{\PYZbs{}}\PY{l+s}{omega\PYZdl{}}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{\PYZdl{}H(}\PY{l+s}{\PYZbs{}}\PY{l+s}{omega)\PYZdl{}}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlim}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{350}\PY{p}{,}\PY{l+m+mi}{350}\PY{p}{)}
              \PY{n}{legend}\PY{o}{=}\PY{n}{ax}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{loc}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{lower right}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{n}{ax}\PY{o}{=}\PY{n}{fig}\PY{o}{.}\PY{n}{add\PYZus{}subplot}\PY{p}{(}\PY{l+m+mi}{122}\PY{p}{)}
              \PY{n}{ax}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{t}\PY{o}{\PYZhy{}}\PY{n}{T}\PY{o}{/}\PY{l+m+mi}{2}\PY{p}{,}\PY{n}{h}\PY{p}{)}      \PY{c}{\PYZsh{}temporal filter power in the time domain}
              \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{time (s)}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{\PYZdl{}h(t)\PYZdl{}}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlim}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{0.5}\PY{p}{,}\PY{l+m+mf}{0.5}\PY{p}{)}
              \PY{n}{plt}\PY{o}{.}\PY{n}{tight\PYZus{}layout}\PY{p}{(}\PY{p}{)}
              \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
          
              \PY{c}{\PYZsh{}4c}
              \PY{c}{\PYZsh{} plt.title(\PYZsq{}Time Domain\PYZsq{})}
              \PY{n}{fig}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{16}\PY{p}{,}\PY{l+m+mi}{8}\PY{p}{)}\PY{p}{)}
              \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{Signal and Estimation}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{n}{ax}\PY{o}{=}\PY{n}{fig}\PY{o}{.}\PY{n}{add\PYZus{}subplot}\PY{p}{(}\PY{l+m+mi}{111}\PY{p}{)}
              \PY{c}{\PYZsh{}neuron pair spikes, time domain}
              \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{t}\PY{p}{,} \PY{n}{r}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{k}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{spikes}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{alpha}\PY{o}{=}\PY{l+m+mf}{0.2}\PY{p}{)}  
              \PY{c}{\PYZsh{}white noise signal, time domain}
              \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{t}\PY{p}{,} \PY{n}{x\PYZus{}t}\PY{p}{,} \PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{\PYZdl{}x(t)\PYZdl{}}\PY{l+s}{\PYZsq{}}\PY{p}{)} 
              \PY{c}{\PYZsh{}normed estimated state, time domain}
              \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{t}\PY{p}{,} \PY{n}{xhat}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{\PYZdl{}}\PY{l+s}{\PYZbs{}}\PY{l+s}{hat\PYZob{}x\PYZcb{}(t)\PYZdl{}}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{n}{legend}\PY{o}{=}\PY{n}{ax}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{loc}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{best}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{time}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
          
              \PY{c}{\PYZsh{}4c}
              \PY{n}{fig}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{16}\PY{p}{,}\PY{l+m+mi}{8}\PY{p}{)}\PY{p}{)}
              \PY{c}{\PYZsh{} plt.title(\PYZsq{}Frequency Domain\PYZsq{})}
              \PY{c}{\PYZsh{} .real removes unnecessary warnings when plotting}
              \PY{n}{ax}\PY{o}{=}\PY{n}{fig}\PY{o}{.}\PY{n}{add\PYZus{}subplot}\PY{p}{(}\PY{l+m+mi}{121}\PY{p}{)}
              \PY{c}{\PYZsh{}unsmoothed white noise signal in frequency domain}
              \PY{n}{ax}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{omega}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{n}{XP}\PY{p}{)}\PY{o}{.}\PY{n}{real}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{\PYZdl{}|X(}\PY{l+s}{\PYZbs{}}\PY{l+s}{omega)|\PYZdl{}}\PY{l+s}{\PYZsq{}}\PY{p}{)}          
              \PY{c}{\PYZsh{}state estimate in frequency domain}
              \PY{n}{ax}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{omega}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{abs}\PY{p}{(}\PY{n}{XHAT}\PY{p}{)}\PY{o}{.}\PY{n}{real}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{\PYZdl{}|}\PY{l+s}{\PYZbs{}}\PY{l+s}{hat\PYZob{}X\PYZcb{}(}\PY{l+s}{\PYZbs{}}\PY{l+s}{omega)|\PYZdl{}}\PY{l+s}{\PYZsq{}}\PY{p}{)}   
              \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{\PYZdl{}}\PY{l+s}{\PYZbs{}}\PY{l+s}{omega\PYZdl{}}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{Value of coefficient}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlim}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{50}\PY{p}{,}\PY{l+m+mi}{50}\PY{p}{)}
              \PY{n}{legend}\PY{o}{=}\PY{n}{ax}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{loc}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{best}\PY{l+s}{\PYZsq{}}\PY{p}{)} 
              \PY{n}{ax}\PY{o}{=}\PY{n}{fig}\PY{o}{.}\PY{n}{add\PYZus{}subplot}\PY{p}{(}\PY{l+m+mi}{122}\PY{p}{)}
              \PY{c}{\PYZsh{}unsmoothed neuron pair spikes frequency domain}
              \PY{n}{ax}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{omega}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{n}{RP}\PY{p}{)}\PY{o}{.}\PY{n}{real}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{\PYZdl{}|R(}\PY{l+s}{\PYZbs{}}\PY{l+s}{omega)|\PYZdl{}}\PY{l+s}{\PYZsq{}}\PY{p}{)} 
              \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{\PYZdl{}}\PY{l+s}{\PYZbs{}}\PY{l+s}{omega\PYZdl{}}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{Value of coefficient}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{n}{legend}\PY{o}{=}\PY{n}{ax}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{loc}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{best}\PY{l+s}{\PYZsq{}}\PY{p}{)} 
              \PY{n}{legend}\PY{o}{=}\PY{n}{ax}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{loc}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{best}\PY{l+s}{\PYZsq{}}\PY{p}{)} 
              \PY{n}{legend}\PY{o}{=}\PY{n}{ax}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{loc}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{best}\PY{l+s}{\PYZsq{}}\PY{p}{)} 
              \PY{n}{plt}\PY{o}{.}\PY{n}{tight\PYZus{}layout}\PY{p}{(}\PY{p}{)}
              \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
          
          \PY{n}{four\PYZus{}a\PYZus{}thru\PYZus{}d}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{SYDE 556-750 Assignment 2_files/SYDE 556-750 Assignment 2_35_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{SYDE 556-750 Assignment 2_files/SYDE 556-750 Assignment 2_35_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{SYDE 556-750 Assignment 2_files/SYDE 556-750 Assignment 2_35_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    The power spectrum for $X$ and $\hat{X}$ align fairly closely, giving a
first indication that the state estimate is capturing the original
signal. $\hat{X}$ does have spurious power above the cutoff due to the
smoothing procedures, which ultimately gives the time-domain signal more
high-frequency components than it should have.

$\hat{X}$ is calculated by convolving the optimal filter in the time
domain $h(t)$ with the neuron response $r(t)$, or by multiplying
$H(\omega)$ with $R(\omega)$ in the frequency domain and taking the
inverse fourier transform:

\begin{itemize}
\itemsep1pt\parskip0pt\parsep0pt
\item
  $\hat{X(}\omega) = H(\omega) R(\omega)$.
\end{itemize}

$X(\omega)$ and $R(\omega)$ are filtered with gaussian windowing in
these plots, but this is an arbitrary filter that isn't related to
$H(\omega)$. They are, however, used to calculate $H(\omega)$:

\begin{itemize}
\itemsep1pt\parskip0pt\parsep0pt
\item
  $H(\omega)=\frac{\langle X(\omega) R^*(\omega) \rangle_A}{\langle |R(\omega)|^2\rangle_A}$,
\end{itemize}

where $\langle \rangle_A$ is the averaging over the gaussian window $A$.

    \paragraph{4e Generate $h(t)$ time plots for the optimal filter for
different \texttt{limit} values of 2Hz, 10Hz, and 30Hz. Describe the
effects on the time plot of the optimal filter as the \texttt{limit}
increases. Why does this
happen?}\label{e-generate-ht-time-plots-for-the-optimal-filter-for-different-limit-values-of-2hz-10hz-and-30hz.-describe-the-effects-on-the-time-plot-of-the-optimal-filter-as-the-limit-increases.-why-does-this-happen}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}132}]:} \PY{k}{def} \PY{n+nf}{four\PYZus{}e}\PY{p}{(}\PY{p}{)}\PY{p}{:}
          
              \PY{n}{T} \PY{o}{=} \PY{l+m+mf}{2.0}         \PY{c}{\PYZsh{} length of signal in seconds}
              \PY{n}{dt} \PY{o}{=} \PY{l+m+mf}{0.001}      \PY{c}{\PYZsh{} time step size}
              \PY{n}{rms}\PY{o}{=}\PY{l+m+mf}{0.5}
              \PY{n}{limit}\PY{o}{=}\PY{l+m+mi}{5}
              \PY{n}{seed}\PY{o}{=}\PY{l+m+mi}{3}          
          
              \PY{c}{\PYZsh{} Neuron creation and spike generation}
              \PY{n}{tau\PYZus{}ref} \PY{o}{=} \PY{l+m+mf}{0.002}         
              \PY{n}{tau\PYZus{}rc} \PY{o}{=} \PY{l+m+mf}{0.02}            
              \PY{n}{x1} \PY{o}{=} \PY{l+m+mf}{0.0}                 
              \PY{n}{a1} \PY{o}{=} \PY{l+m+mf}{40.0}
              \PY{n}{x2} \PY{o}{=} \PY{l+m+mf}{1.0}                 
              \PY{n}{a2} \PY{o}{=} \PY{l+m+mf}{150.0}
              \PY{n}{e1}\PY{o}{=}\PY{l+m+mi}{1}
              \PY{n}{e2}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}
              \PY{n}{x1\PYZus{}dot\PYZus{}e1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{x1}\PY{p}{,}\PY{n}{e1}\PY{p}{)}
              \PY{n}{x2\PYZus{}dot\PYZus{}e1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{x2}\PY{p}{,}\PY{n}{e1}\PY{p}{)}
              \PY{n}{x1\PYZus{}dot\PYZus{}e2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{x1}\PY{p}{,}\PY{n}{e2}\PY{p}{)}
              \PY{n}{x2\PYZus{}dot\PYZus{}e2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{x2}\PY{p}{,}\PY{n}{e2}\PY{p}{)}
              \PY{n}{n1}\PY{o}{=}\PY{n}{spikingLIFneuron}\PY{p}{(}\PY{n}{x1\PYZus{}dot\PYZus{}e1}\PY{p}{,}\PY{n}{x2\PYZus{}dot\PYZus{}e1}\PY{p}{,}\PY{n}{a1}\PY{p}{,}\PY{n}{a2}\PY{p}{,}\PY{n}{e1}\PY{p}{,}\PY{n}{tau\PYZus{}ref}\PY{p}{,}\PY{n}{tau\PYZus{}rc}\PY{p}{)}
              \PY{n}{n2}\PY{o}{=}\PY{n}{spikingLIFneuron}\PY{p}{(}\PY{n}{x1\PYZus{}dot\PYZus{}e2}\PY{p}{,}\PY{n}{x2\PYZus{}dot\PYZus{}e2}\PY{p}{,}\PY{n}{a1}\PY{p}{,}\PY{n}{a2}\PY{p}{,}\PY{n}{e2}\PY{p}{,}\PY{n}{tau\PYZus{}ref}\PY{p}{,}\PY{n}{tau\PYZus{}rc}\PY{p}{)}
          
              \PY{n}{fig}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{16}\PY{p}{,}\PY{l+m+mi}{16}\PY{p}{)}\PY{p}{)}
              \PY{n}{ax}\PY{o}{=}\PY{n}{fig}\PY{o}{.}\PY{n}{add\PYZus{}subplot}\PY{p}{(}\PY{l+m+mi}{211}\PY{p}{)}
              \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{time (s)}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{\PYZdl{}h(t)\PYZdl{}}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlim}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{0.2}\PY{p}{,}\PY{l+m+mf}{0.2}\PY{p}{)}
              \PY{n}{ax2}\PY{o}{=}\PY{n}{fig}\PY{o}{.}\PY{n}{add\PYZus{}subplot}\PY{p}{(}\PY{l+m+mi}{212}\PY{p}{)}
              \PY{n}{ax2}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{\PYZdl{}}\PY{l+s}{\PYZbs{}}\PY{l+s}{omega\PYZdl{}}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{n}{ax2}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{\PYZdl{}H(}\PY{l+s}{\PYZbs{}}\PY{l+s}{omega)\PYZdl{}}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{n}{ax2}\PY{o}{.}\PY{n}{set\PYZus{}xlim}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{350}\PY{p}{,}\PY{l+m+mi}{350}\PY{p}{)}
          
              \PY{n}{limits}\PY{o}{=}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{,}\PY{l+m+mi}{30}\PY{p}{]}
              \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{limits}\PY{p}{)}\PY{p}{)}\PY{p}{:}  
                  \PY{n}{seed}\PY{o}{=}\PY{n}{i}
                  \PY{n}{limit}\PY{o}{=}\PY{n}{limits}\PY{p}{[}\PY{n}{i}\PY{p}{]}
                  \PY{n}{x\PYZus{}t}\PY{p}{,} \PY{n}{x\PYZus{}w} \PY{o}{=} \PY{n}{generate\PYZus{}signal}\PY{p}{(}\PY{n}{T}\PY{p}{,}\PY{n}{dt}\PY{p}{,}\PY{n}{rms}\PY{p}{,}\PY{n}{limit}\PY{p}{,}\PY{n}{seed}\PY{p}{,}\PY{l+s}{\PYZsq{}}\PY{l+s}{uniform}\PY{l+s}{\PYZsq{}}\PY{p}{)}
                  \PY{n}{Nt} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{x\PYZus{}t}\PY{p}{)}                
                  \PY{n}{t} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{n}{Nt}\PY{p}{)} \PY{o}{*} \PY{n}{dt}
                  \PY{n}{stimulus} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{x\PYZus{}t}\PY{p}{)}   
                  \PY{n}{n1}\PY{o}{.}\PY{n}{set\PYZus{}spikes}\PY{p}{(}\PY{n}{stimulus}\PY{p}{,}\PY{n}{T}\PY{p}{,}\PY{n}{dt}\PY{p}{)} 
                  \PY{n}{n2}\PY{o}{.}\PY{n}{set\PYZus{}spikes}\PY{p}{(}\PY{n}{stimulus}\PY{p}{,}\PY{n}{T}\PY{p}{,}\PY{n}{dt}\PY{p}{)}
                  \PY{n}{spikes1}\PY{o}{=}\PY{n}{n1}\PY{o}{.}\PY{n}{get\PYZus{}spikes}\PY{p}{(}\PY{p}{)}     
                  \PY{n}{spikes2}\PY{o}{=}\PY{n}{n2}\PY{o}{.}\PY{n}{get\PYZus{}spikes}\PY{p}{(}\PY{p}{)}
                  \PY{n}{spikes}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{n}{spikes1}\PY{p}{,}\PY{n}{spikes2}\PY{p}{]}\PY{p}{)}
          
                  \PY{n}{freq} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{n}{Nt}\PY{p}{)}\PY{o}{/}\PY{n}{T} \PY{o}{\PYZhy{}} \PY{n}{Nt}\PY{o}{/}\PY{p}{(}\PY{l+m+mf}{2.0}\PY{o}{*}\PY{n}{T}\PY{p}{)}   
                  \PY{n}{omega} \PY{o}{=} \PY{n}{freq}\PY{o}{*}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{pi}                  
          
                  \PY{n}{r} \PY{o}{=} \PY{n}{spikes}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{\PYZhy{}} \PY{n}{spikes}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}               
                  \PY{n}{R} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{fft}\PY{o}{.}\PY{n}{fftshift}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{fft}\PY{o}{.}\PY{n}{fft}\PY{p}{(}\PY{n}{r}\PY{p}{)}\PY{p}{)}
                  \PY{n}{X}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{fft}\PY{o}{.}\PY{n}{fftshift}\PY{p}{(}\PY{n}{x\PYZus{}w}\PY{p}{)}                                 
          
                  \PY{n}{sigma\PYZus{}t} \PY{o}{=} \PY{l+m+mf}{0.025}                          
                  \PY{n}{W2} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{exp}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{omega}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{sigma\PYZus{}t}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}     
                  \PY{n}{W2} \PY{o}{=} \PY{n}{W2} \PY{o}{/} \PY{n+nb}{sum}\PY{p}{(}\PY{n}{W2}\PY{p}{)}                        
          
                  \PY{n}{CP} \PY{o}{=} \PY{n}{X}\PY{o}{*}\PY{n}{R}\PY{o}{.}\PY{n}{conjugate}\PY{p}{(}\PY{p}{)}  
                  \PY{n}{WCP} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{convolve}\PY{p}{(}\PY{n}{CP}\PY{p}{,} \PY{n}{W2}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{same}\PY{l+s}{\PYZsq{}}\PY{p}{)}  
                  \PY{n}{RP} \PY{o}{=} \PY{n}{R}\PY{o}{*}\PY{n}{R}\PY{o}{.}\PY{n}{conjugate}\PY{p}{(}\PY{p}{)}
                  \PY{n}{WRP} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{convolve}\PY{p}{(}\PY{n}{RP}\PY{p}{,} \PY{n}{W2}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{same}\PY{l+s}{\PYZsq{}}\PY{p}{)}   
                  \PY{n}{XP} \PY{o}{=} \PY{n}{X}\PY{o}{*}\PY{n}{X}\PY{o}{.}\PY{n}{conjugate}\PY{p}{(}\PY{p}{)}
                  \PY{n}{WXP} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{convolve}\PY{p}{(}\PY{n}{XP}\PY{p}{,} \PY{n}{W2}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{same}\PY{l+s}{\PYZsq{}}\PY{p}{)}  
                  \PY{n}{H} \PY{o}{=} \PY{n}{WCP} \PY{o}{/} \PY{n}{WRP}
                  \PY{n}{H\PYZus{}unsmoothed} \PY{o}{=} \PY{n}{CP} \PY{o}{/} \PY{n}{RP}
          
                  \PY{n}{h} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{fft}\PY{o}{.}\PY{n}{fftshift}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{fft}\PY{o}{.}\PY{n}{ifft}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{fft}\PY{o}{.}\PY{n}{ifftshift}\PY{p}{(}\PY{n}{H}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{o}{.}\PY{n}{real}
                  \PY{n}{ax}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{t}\PY{o}{\PYZhy{}}\PY{n}{T}\PY{o}{/}\PY{l+m+mi}{2}\PY{p}{,}\PY{n}{h}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{limit=}\PY{l+s+si}{\PYZpc{}s}\PY{l+s}{Hz}\PY{l+s}{\PYZsq{}} \PY{o}{\PYZpc{}}\PY{p}{(}\PY{n}{limits}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}\PY{p}{)}
                  \PY{n}{ax2}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{omega}\PY{p}{,}\PY{n}{H}\PY{o}{.}\PY{n}{real}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{limit=}\PY{l+s+si}{\PYZpc{}s}\PY{l+s}{Hz}\PY{l+s}{\PYZsq{}} \PY{o}{\PYZpc{}}\PY{p}{(}\PY{n}{limits}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}\PY{p}{)}
          
              \PY{n}{legend}\PY{o}{=}\PY{n}{ax}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{loc}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{upper right}\PY{l+s}{\PYZsq{}}\PY{p}{,}\PY{n}{shadow}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
              \PY{n}{legend}\PY{o}{=}\PY{n}{ax2}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{loc}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{upper right}\PY{l+s}{\PYZsq{}}\PY{p}{,}\PY{n}{shadow}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
              \PY{n}{plt}\PY{o}{.}\PY{n}{tight\PYZus{}layout}\PY{p}{(}\PY{p}{)}
              \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
              
          \PY{n}{four\PYZus{}e}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{SYDE 556-750 Assignment 2_files/SYDE 556-750 Assignment 2_38_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    Increasing the frequency limit of the signal compresses the temporal
filter in time, causing the decaying oscillations to occur nearer to
$t=0$ and with greater magnitude. Mathematically, increasing the limit
increases the width of $H(\omega)$ due to a wider $X(\omega)$ in the
numerator $X(\omega)*R(\omega)$. This preserves a greater number of high
frequency components and more rapid oscillations in the time domain.
These oscillations add coherently near $t=0$ increasing the filter's
power, but add destructively as $t \rightarrow \infty$, decreasing the
filter's power. Intuitively, having a wider $H(\omega)$ means capturing
more high-frequency components. In order to not smooth out these
components in the time domain near $t=0$, the temporal filter $h(t)$
needs to oscillate on short time scales.

    \subsection{5) Using Post-Synaptic Currents as a
Filter}\label{using-post-synaptic-currents-as-a-filter}

Instead of using the optimal filter from the previous question, now we
will use the post-synaptic current instead. This is of the form
$h(t)=t^n e^{-t/\tau}$ normalized to area 1.

    \paragraph{5a Plot the normalized $h(t)$ for $n$=0, 1, and 2 with
$\tau$=0.007 seconds. What two things do you expect increasing $n$ will
do to
$\hat{x}(t)$?}\label{a-plot-the-normalized-ht-for-n0-1-and-2-with-tau0.007-seconds.-what-two-things-do-you-expect-increasing-n-will-do-to-hatxt}

    \paragraph{5b Plot the normalized $h(t)$ for $\tau$=0.002, 0.005, 0.01,
and 0.02 seconds with $n$=0. What two things do you expect increasing
$\tau$ will do to
$\hat{x}(t)$?}\label{b-plot-the-normalized-ht-for-tau0.002-0.005-0.01-and-0.02-seconds-with-n0.-what-two-things-do-you-expect-increasing-tau-will-do-to-hatxt}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}133}]:} \PY{k}{def} \PY{n+nf}{five\PYZus{}a\PYZus{}thru\PYZus{}b}\PY{p}{(}\PY{p}{)}\PY{p}{:}
          
              \PY{c}{\PYZsh{}5a}
              \PY{n}{T}\PY{o}{=}\PY{l+m+mi}{1}
              \PY{n}{dt}\PY{o}{=}\PY{l+m+mf}{0.001}
              \PY{n}{tau}\PY{o}{=}\PY{l+m+mf}{0.007}
              \PY{n}{t}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{n}{T}\PY{o}{/}\PY{n}{dt}\PY{p}{)}\PY{o}{*}\PY{n}{dt}
              \PY{n}{n\PYZus{}list}\PY{o}{=}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{]}
          
              \PY{n}{fig}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{16}\PY{p}{,}\PY{l+m+mi}{8}\PY{p}{)}\PY{p}{)}
              \PY{n}{ax}\PY{o}{=}\PY{n}{fig}\PY{o}{.}\PY{n}{add\PYZus{}subplot}\PY{p}{(}\PY{l+m+mi}{111}\PY{p}{)}
              \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{time (s)}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{\PYZdl{}h(t)\PYZdl{}}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{k}{for} \PY{n}{n} \PY{o+ow}{in} \PY{n}{n\PYZus{}list}\PY{p}{:}
                  \PY{n}{h}\PY{o}{=}\PY{n}{t}\PY{o}{*}\PY{o}{*}\PY{n}{n}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{exp}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{t}\PY{o}{/}\PY{n}{tau}\PY{p}{)}
                  \PY{n}{h}\PY{o}{=}\PY{n}{h}\PY{o}{/}\PY{n}{np}\PY{o}{.}\PY{n}{linalg}\PY{o}{.}\PY{n}{norm}\PY{p}{(}\PY{n}{h}\PY{p}{)}
                  \PY{n}{ax}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{t}\PY{p}{,}\PY{n}{h}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{n=}\PY{l+s+si}{\PYZpc{}s}\PY{l+s}{\PYZsq{}} \PY{o}{\PYZpc{}}\PY{k}{n})
              \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlim}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mf}{0.05}\PY{p}{)}
              \PY{n}{legend}\PY{o}{=}\PY{n}{ax}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{loc}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{best}\PY{l+s}{\PYZsq{}}\PY{p}{,}\PY{n}{shadow}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
              \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
          
              \PY{c}{\PYZsh{}5b}
              \PY{n}{T}\PY{o}{=}\PY{l+m+mi}{1}
              \PY{n}{dt}\PY{o}{=}\PY{l+m+mf}{0.001}
              \PY{n}{n}\PY{o}{=}\PY{l+m+mi}{0}
              \PY{n}{t}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{n}{T}\PY{o}{/}\PY{n}{dt}\PY{p}{)}\PY{o}{*}\PY{n}{dt}
              \PY{n}{tau\PYZus{}list}\PY{o}{=}\PY{p}{[}\PY{l+m+mf}{0.002}\PY{p}{,}\PY{l+m+mf}{0.005}\PY{p}{,}\PY{l+m+mf}{0.01}\PY{p}{]}
          
              \PY{n}{fig}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{16}\PY{p}{,}\PY{l+m+mi}{8}\PY{p}{)}\PY{p}{)}
              \PY{n}{ax}\PY{o}{=}\PY{n}{fig}\PY{o}{.}\PY{n}{add\PYZus{}subplot}\PY{p}{(}\PY{l+m+mi}{111}\PY{p}{)}
              \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{time (s)}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{\PYZdl{}h(t)\PYZdl{}}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{k}{for} \PY{n}{tau} \PY{o+ow}{in} \PY{n}{tau\PYZus{}list}\PY{p}{:}
                  \PY{n}{h}\PY{o}{=}\PY{n}{t}\PY{o}{*}\PY{o}{*}\PY{n}{n}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{exp}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{t}\PY{o}{/}\PY{n}{tau}\PY{p}{)}
                  \PY{n}{h}\PY{o}{=}\PY{n}{h}\PY{o}{/}\PY{n}{np}\PY{o}{.}\PY{n}{linalg}\PY{o}{.}\PY{n}{norm}\PY{p}{(}\PY{n}{h}\PY{p}{)}
                  \PY{n}{ax}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{t}\PY{p}{,}\PY{n}{h}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{\PYZdl{}}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s}{tau\PYZdl{} = }\PY{l+s+si}{\PYZpc{}s}\PY{l+s}{ s}\PY{l+s}{\PYZsq{}} \PY{o}{\PYZpc{}}\PY{k}{tau})
              \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlim}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mf}{0.05}\PY{p}{)}
              \PY{n}{legend}\PY{o}{=}\PY{n}{ax}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{loc}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{best}\PY{l+s}{\PYZsq{}}\PY{p}{,}\PY{n}{shadow}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
              \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
              
          \PY{n}{five\PYZus{}a\PYZus{}thru\PYZus{}b}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{SYDE 556-750 Assignment 2_files/SYDE 556-750 Assignment 2_43_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{SYDE 556-750 Assignment 2_files/SYDE 556-750 Assignment 2_43_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    I expect increasing $n$ to increase the amount of smoothing on
$\hat{x}$, because $h$ extends farther in time with larger $n$, and so
spreads the spikes farther out in time. Given the result of 5a, I also
expect that a wider filter will decrease the high-frequency components
of the signal. I expect increasing $n$ to cause greater lag in
$\hat{x}$, because the peak of $h$ moves farther from zero with larger
$n$ (sort of like a shifting center of mass for the filter).

    I expect increasing $\tau$ to increase the amount of smoothing (in time)
on $\hat{x}$, because $h$ extends farther in time with larger $\tau$.
This will decrease the magnitude of the decoded signal (due to the lower
power of $h$ at each $t$) as well as reduce high-frequency components,
as above.

    \paragraph{5c Decode $\hat{x}(t)$ from the spikes generated in question
3.d using an $h(t)$ with $n$=0 and $\tau$=0.007. Do this by generating
the spikes, filtering them with $h(t)$, and using that as your activity
matrix $A$ to compute your decoders. Plot the time and frequency plots
for this $h(t)$. Plot the $x(t)$ signal, the spikes, and the decoded
$\hat{x}(t)$
value.}\label{c-decode-hatxt-from-the-spikes-generated-in-question-3.d-using-an-ht-with-n0-and-tau0.007.-do-this-by-generating-the-spikes-filtering-them-with-ht-and-using-that-as-your-activity-matrix-a-to-compute-your-decoders.-plot-the-time-and-frequency-plots-for-this-ht.-plot-the-xt-signal-the-spikes-and-the-decoded-hatxt-value.}

    \paragraph{5d Use the same decoder and $h(t)$ as in part (c), but
generate a new $x(t)$ with \texttt{limit}=5Hz. Plot the $x(t)$ signal,
the spikes, and the decoded $\hat{x}(t)$ value. How do these decodings
compare?}\label{d-use-the-same-decoder-and-ht-as-in-part-c-but-generate-a-new-xt-with-limit5hz.-plot-the-xt-signal-the-spikes-and-the-decoded-hatxt-value.-how-do-these-decodings-compare}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}134}]:} \PY{k}{def} \PY{n+nf}{five\PYZus{}c\PYZus{}thru\PYZus{}d}\PY{p}{(}\PY{p}{)}\PY{p}{:}
          
              \PY{n}{x1}\PY{o}{=}\PY{l+m+mi}{0}
              \PY{n}{x2}\PY{o}{=}\PY{l+m+mi}{1}
              \PY{n}{a1}\PY{o}{=}\PY{l+m+mi}{40}
              \PY{n}{a2}\PY{o}{=}\PY{l+m+mi}{150}
              \PY{n}{e1}\PY{o}{=}\PY{l+m+mi}{1}
              \PY{n}{e2}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}
              \PY{n}{tau\PYZus{}ref}\PY{o}{=}\PY{l+m+mf}{0.002}
              \PY{n}{tau\PYZus{}rc}\PY{o}{=}\PY{l+m+mf}{0.02}
              \PY{n}{T}\PY{o}{=}\PY{l+m+mi}{1}
              \PY{n}{dt}\PY{o}{=}\PY{l+m+mf}{0.001}
              \PY{n}{rms}\PY{o}{=}\PY{l+m+mf}{0.5}
              \PY{n}{limit}\PY{o}{=}\PY{l+m+mi}{30}
              \PY{n}{n}\PY{o}{=}\PY{l+m+mi}{0}
              \PY{n}{tau\PYZus{}synapse}\PY{o}{=}\PY{l+m+mf}{0.007}
              \PY{n}{seed}\PY{o}{=}\PY{l+m+mi}{3}      \PY{c}{\PYZsh{}new seed to generate new x(t)}
          
              \PY{c}{\PYZsh{}create neurons, generate signals, generate spikes}
              \PY{n}{x1\PYZus{}dot\PYZus{}e1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{x1}\PY{p}{,}\PY{n}{e1}\PY{p}{)}
              \PY{n}{x2\PYZus{}dot\PYZus{}e1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{x2}\PY{p}{,}\PY{n}{e1}\PY{p}{)}
              \PY{n}{x1\PYZus{}dot\PYZus{}e2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{x1}\PY{p}{,}\PY{n}{e2}\PY{p}{)}
              \PY{n}{x2\PYZus{}dot\PYZus{}e2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{x2}\PY{p}{,}\PY{n}{e2}\PY{p}{)}
              \PY{n}{n1}\PY{o}{=}\PY{n}{spikingLIFneuron}\PY{p}{(}\PY{n}{x1\PYZus{}dot\PYZus{}e1}\PY{p}{,}\PY{n}{x2\PYZus{}dot\PYZus{}e1}\PY{p}{,}\PY{n}{a1}\PY{p}{,}\PY{n}{a2}\PY{p}{,}\PY{n}{e1}\PY{p}{,}\PY{n}{tau\PYZus{}ref}\PY{p}{,}\PY{n}{tau\PYZus{}rc}\PY{p}{)}
              \PY{n}{n2}\PY{o}{=}\PY{n}{spikingLIFneuron}\PY{p}{(}\PY{n}{x1\PYZus{}dot\PYZus{}e2}\PY{p}{,}\PY{n}{x2\PYZus{}dot\PYZus{}e2}\PY{p}{,}\PY{n}{a1}\PY{p}{,}\PY{n}{a2}\PY{p}{,}\PY{n}{e2}\PY{p}{,}\PY{n}{tau\PYZus{}ref}\PY{p}{,}\PY{n}{tau\PYZus{}rc}\PY{p}{)}
              \PY{n}{t}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{n+nb}{int}\PY{p}{(}\PY{n}{T}\PY{o}{/}\PY{n}{dt}\PY{p}{)}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{*}\PY{n}{dt}
              \PY{n}{x\PYZus{}t}\PY{p}{,} \PY{n}{x\PYZus{}w} \PY{o}{=} \PY{n}{generate\PYZus{}signal}\PY{p}{(}\PY{n}{T}\PY{p}{,}\PY{n}{dt}\PY{p}{,}\PY{n}{rms}\PY{p}{,}\PY{n}{limit}\PY{p}{,}\PY{n}{seed}\PY{p}{,}\PY{l+s}{\PYZsq{}}\PY{l+s}{uniform}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{n}{stimulus} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{x\PYZus{}t}\PY{p}{)}
              \PY{n}{n1}\PY{o}{.}\PY{n}{set\PYZus{}spikes}\PY{p}{(}\PY{n}{stimulus}\PY{p}{,}\PY{n}{T}\PY{p}{,}\PY{n}{dt}\PY{p}{)}
              \PY{n}{n2}\PY{o}{.}\PY{n}{set\PYZus{}spikes}\PY{p}{(}\PY{n}{stimulus}\PY{p}{,}\PY{n}{T}\PY{p}{,}\PY{n}{dt}\PY{p}{)}
              \PY{n}{spikes1}\PY{o}{=}\PY{n}{n1}\PY{o}{.}\PY{n}{get\PYZus{}spikes}\PY{p}{(}\PY{p}{)}
              \PY{n}{spikes2}\PY{o}{=}\PY{n}{n2}\PY{o}{.}\PY{n}{get\PYZus{}spikes}\PY{p}{(}\PY{p}{)}
          
              \PY{c}{\PYZsh{}set post\PYZhy{}synaptic current temporal filter}
              \PY{n}{Nt} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{x\PYZus{}t}\PY{p}{)}                
              \PY{n}{freq} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{n}{Nt}\PY{p}{)}\PY{o}{/}\PY{n}{T} \PY{o}{\PYZhy{}} \PY{n}{Nt}\PY{o}{/}\PY{p}{(}\PY{l+m+mf}{2.0}\PY{o}{*}\PY{n}{T}\PY{p}{)}   
              \PY{n}{omega} \PY{o}{=} \PY{n}{freq}\PY{o}{*}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{pi}                  
              \PY{n}{spikes}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{n}{spikes1}\PY{p}{,}\PY{n}{spikes2}\PY{p}{]}\PY{p}{)}
              \PY{n}{h}\PY{o}{=}\PY{n}{t}\PY{o}{*}\PY{o}{*}\PY{n}{n}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{exp}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{t}\PY{o}{/}\PY{n}{tau\PYZus{}synapse}\PY{p}{)}
              \PY{n}{h}\PY{o}{=}\PY{n}{h}\PY{o}{/}\PY{n}{np}\PY{o}{.}\PY{n}{linalg}\PY{o}{.}\PY{n}{norm}\PY{p}{(}\PY{n}{h}\PY{p}{)}
              \PY{n}{H}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{fft}\PY{o}{.}\PY{n}{fft}\PY{p}{(}\PY{n}{h}\PY{p}{)}
          
              \PY{c}{\PYZsh{}calculate decoders and filtered state estimate using smoothed spike data}
              \PY{n}{d}\PY{o}{=}\PY{n}{get\PYZus{}decoders\PYZus{}smoothed}\PY{p}{(}\PY{n}{spikes}\PY{p}{,}\PY{n}{h}\PY{p}{,}\PY{n}{x\PYZus{}t}\PY{p}{)}
              \PY{n}{xhat}\PY{o}{=}\PY{n}{get\PYZus{}estimate\PYZus{}smoothed}\PY{p}{(}\PY{n}{spikes}\PY{p}{,}\PY{n}{h}\PY{p}{,}\PY{n}{d}\PY{p}{)}
          
              \PY{c}{\PYZsh{}plot}
              \PY{n}{fig}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{16}\PY{p}{,}\PY{l+m+mi}{8}\PY{p}{)}\PY{p}{)}
              \PY{n}{ax}\PY{o}{=}\PY{n}{fig}\PY{o}{.}\PY{n}{add\PYZus{}subplot}\PY{p}{(}\PY{l+m+mi}{111}\PY{p}{)}
              \PY{n}{ax}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{t}\PY{p}{,}\PY{n}{x\PYZus{}t}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{\PYZdl{}x(t)\PYZdl{} = smoothed white noise}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{c}{\PYZsh{}neuron pair response function in time domain}
              \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{t}\PY{p}{,}\PY{p}{(}\PY{n}{spikes}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{\PYZhy{}}\PY{n}{spikes}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{k}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{spikes}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{alpha}\PY{o}{=}\PY{l+m+mf}{0.2}\PY{p}{)}  
              \PY{n}{ax}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{t}\PY{p}{,}\PY{n}{xhat}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{\PYZdl{}}\PY{l+s}{\PYZbs{}}\PY{l+s}{hat\PYZob{}x\PYZcb{}(t)\PYZdl{}, \PYZdl{}}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s}{tau\PYZdl{} = }\PY{l+s+si}{\PYZpc{}s}\PY{l+s}{\PYZsq{}} \PY{o}{\PYZpc{}}\PY{k}{tau\PYZus{}synapse})
              \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{time (s)}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{n}{legend}\PY{o}{=}\PY{n}{ax}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{loc}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{best}\PY{l+s}{\PYZsq{}}\PY{p}{)} 
              \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
          
              \PY{n}{fig}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{16}\PY{p}{,}\PY{l+m+mi}{8}\PY{p}{)}\PY{p}{)}
              \PY{n}{ax}\PY{o}{=}\PY{n}{fig}\PY{o}{.}\PY{n}{add\PYZus{}subplot}\PY{p}{(}\PY{l+m+mi}{121}\PY{p}{)}
              \PY{n}{ax}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{omega}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{fft}\PY{o}{.}\PY{n}{fftshift}\PY{p}{(}\PY{n}{H}\PY{p}{)}\PY{o}{.}\PY{n}{real}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{\PYZdl{}H(}\PY{l+s}{\PYZbs{}}\PY{l+s}{omega)\PYZdl{}}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{\PYZdl{}}\PY{l+s}{\PYZbs{}}\PY{l+s}{omega\PYZdl{}}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{\PYZdl{}H(}\PY{l+s}{\PYZbs{}}\PY{l+s}{omega)\PYZdl{}}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlim}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{350}\PY{p}{,}\PY{l+m+mi}{350}\PY{p}{)}
              \PY{n}{legend}\PY{o}{=}\PY{n}{ax}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{loc}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{upper right}\PY{l+s}{\PYZsq{}}\PY{p}{)} 
              \PY{n}{ax}\PY{o}{=}\PY{n}{fig}\PY{o}{.}\PY{n}{add\PYZus{}subplot}\PY{p}{(}\PY{l+m+mi}{122}\PY{p}{)}
              \PY{n}{ax}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{t}\PY{p}{,}\PY{n}{h}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{\PYZdl{}h(t)\PYZdl{}}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{time (s)}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{\PYZdl{}h(t)\PYZdl{}}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlim}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mf}{0.02}\PY{p}{)}
              \PY{n}{legend}\PY{o}{=}\PY{n}{ax}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{loc}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{upper right}\PY{l+s}{\PYZsq{}}\PY{p}{)} 
              \PY{n}{plt}\PY{o}{.}\PY{n}{tight\PYZus{}layout}\PY{p}{(}\PY{p}{)}
              \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
          
              \PY{c}{\PYZsh{}5d}
              \PY{n}{seed} \PY{o}{=} \PY{l+m+mi}{9}      \PY{c}{\PYZsh{}new seed to generate a fresh x(t)}
              \PY{n}{limit}\PY{o}{=}\PY{l+m+mi}{5}       \PY{c}{\PYZsh{}generate a new signal with limit=5hz}
              \PY{n}{x\PYZus{}t2}\PY{p}{,} \PY{n}{x\PYZus{}w2} \PY{o}{=} \PY{n}{generate\PYZus{}signal}\PY{p}{(}\PY{n}{T}\PY{p}{,}\PY{n}{dt}\PY{p}{,}\PY{n}{rms}\PY{p}{,}\PY{n}{limit}\PY{p}{,}\PY{n}{seed}\PY{p}{,}\PY{l+s}{\PYZsq{}}\PY{l+s}{uniform}\PY{l+s}{\PYZsq{}}\PY{p}{)} 
              \PY{n}{stimulus2} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{x\PYZus{}t2}\PY{p}{)}
              \PY{n}{n1}\PY{o}{.}\PY{n}{set\PYZus{}spikes}\PY{p}{(}\PY{n}{stimulus2}\PY{p}{,}\PY{n}{T}\PY{p}{,}\PY{n}{dt}\PY{p}{)} \PY{c}{\PYZsh{}generate new spikes}
              \PY{n}{n2}\PY{o}{.}\PY{n}{set\PYZus{}spikes}\PY{p}{(}\PY{n}{stimulus2}\PY{p}{,}\PY{n}{T}\PY{p}{,}\PY{n}{dt}\PY{p}{)}
              \PY{n}{spikes3}\PY{o}{=}\PY{n}{n1}\PY{o}{.}\PY{n}{get\PYZus{}spikes}\PY{p}{(}\PY{p}{)}
              \PY{n}{spikes4}\PY{o}{=}\PY{n}{n2}\PY{o}{.}\PY{n}{get\PYZus{}spikes}\PY{p}{(}\PY{p}{)}
              \PY{n}{spikes2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{n}{spikes3}\PY{p}{,}\PY{n}{spikes4}\PY{p}{]}\PY{p}{)}
              \PY{n}{xhat2}\PY{o}{=}\PY{n}{get\PYZus{}estimate\PYZus{}smoothed}\PY{p}{(}\PY{n}{spikes2}\PY{p}{,}\PY{n}{h}\PY{p}{,}\PY{n}{d}\PY{p}{)} \PY{c}{\PYZsh{}estimate the new state with the old decoders}
          
              \PY{n}{fig}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{16}\PY{p}{,}\PY{l+m+mi}{8}\PY{p}{)}\PY{p}{)}
              \PY{n}{ax}\PY{o}{=}\PY{n}{fig}\PY{o}{.}\PY{n}{add\PYZus{}subplot}\PY{p}{(}\PY{l+m+mi}{111}\PY{p}{)}
              \PY{n}{ax}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{t}\PY{p}{,}\PY{n}{x\PYZus{}t2}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{\PYZdl{}x(t)\PYZdl{} = smoothed white noise}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{c}{\PYZsh{}neuron pair response function in time domain}
              \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{t}\PY{p}{,}\PY{p}{(}\PY{n}{spikes2}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{\PYZhy{}}\PY{n}{spikes}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{k}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{spikes}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{alpha}\PY{o}{=}\PY{l+m+mf}{0.2}\PY{p}{)}
              \PY{n}{ax}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{t}\PY{p}{,}\PY{n}{xhat2}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{\PYZdl{}}\PY{l+s}{\PYZbs{}}\PY{l+s}{hat\PYZob{}x\PYZcb{}(t)\PYZdl{}, old decoders, \PYZdl{}}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s}{tau\PYZdl{} = }\PY{l+s+si}{\PYZpc{}s}\PY{l+s}{\PYZsq{}} \PY{o}{\PYZpc{}}\PY{k}{tau\PYZus{}synapse})
              \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{time (s)}\PY{l+s}{\PYZsq{}}\PY{p}{)}
              \PY{n}{legend}\PY{o}{=}\PY{n}{ax}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{loc}\PY{o}{=}\PY{l+s}{\PYZsq{}}\PY{l+s}{best}\PY{l+s}{\PYZsq{}}\PY{p}{)} 
              \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
          
          \PY{n}{five\PYZus{}c\PYZus{}thru\PYZus{}d}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{SYDE 556-750 Assignment 2_files/SYDE 556-750 Assignment 2_48_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{SYDE 556-750 Assignment 2_files/SYDE 556-750 Assignment 2_48_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{SYDE 556-750 Assignment 2_files/SYDE 556-750 Assignment 2_48_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    The estimate of the new signal works pretty well with the postsynaptic
filter calculated using the old decoders. In both cases the small number
of neurons makes it hard to capture the magnitude of the signal or
transitions from positive to negative, but the old decoder estimate
captures positive/negative values with only a small delay. The fidelity
of an estimate calculated with the old decoders to a new signal
indicates that postsynaptic filtering can be applied to estimate many
signals without needing to fine-tune its parameters ($\tau$), which is
advantageous for biological brains conserving mechanisms across diverse
cognitive systems. The error is also comparable to that of the optimal
filter, without requiring an optimization procedure, indicating it may
be a suitable (and biologically motivated) substitute for the optimal
filter.


    % Add a bibliography block to the postdoc
    
    
    
    \end{document}
